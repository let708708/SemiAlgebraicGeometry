\documentclass[uplatex, dvipdfmx]{jsarticle}

\usepackage{amsmath,amssymb}
\usepackage{amsthm}
\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{cleveref}

\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\Ralg}{\mathbb{R}_\mathrm{alg}}
\newcommand{\Qua}{\mathfrak{Q}}
\newcommand{\M}{\mathfrak{M}}
\newcommand{\defiff}{ :\Leftrightarrow}
\newcommand{\RCF}{\mathrm{RCF}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\psc}{\mathrm{psc}}
\newcommand{\PROJ}{\mathrm{PROJ}}
\newcommand{\sign}{\mathrm{sign}}
\newcommand{\map}[3]{{#1}:{#2}\rightarrow{#3}}

\theoremstyle{definition}
\newtheorem{definition}{定義}[section]
\crefname{definition}{定義}{定義}%
\newtheorem{proposition}{命題}[section]
\crefname{proposition}{命題}{命題}%
\newtheorem{lemma}{補題}[section]
\crefname{lemma}{補題}{補題}%
\newtheorem{theorem}{定理}[section]
\crefname{theorem}{定理}{定理}%
\newtheorem{corollary}{系}[section]
\crefname{corollary}{系}{系}%S
\newtheorem*{claim*}{主張}
\newtheorem{remark}{注意}[section]
\newtheorem{example}{例}[section]

\renewcommand{\proofname}{\textbf{証明}}

\begin{document}

\title{実閉体上の柱状代数分解による量化記号消去}
\author{富永 直弥}
\maketitle

\section{基礎的な定義}
% コンピュータによって「具体的な問題の」量化記号消去を行うというモチベーションで議論を進める．
% すると実数体を扱えないことから，実数体の公理を抜き出す動機が生まれそう？

\subsection{実閉体}
% この節では，Artin-Schreierにより導入された実閉体の理論を復習する．
% 実閉体の概念はArtinが1927年にHilbertの第17問題を解くのにあたり導入された．

% また，この説では参考文献\cite{Arai}に従い定義を書く．

\begin{definition}[順序体と実体の定義]
     体$F$と$F$上の全順序構造$<$の組$(F,<)$が次の性質を満たすとき，$(F,<)$を順序体(ordered field)という．
     \begin{enumerate}
          \item 任意の$x,y,z\in F$に対し，$x \leq y$ならば$x + z \leq y + z$である．
          \item 任意の$x,y \in F$に対し，$x \geq 0$, $y \geq 0$ならば$x \cdot y \geq 0$である．
     \end{enumerate}

     また，体$F$が，任意の有限個の$F$の元$x_1, \dots, x_n \in F$について, $-1 \neq \sum_{i=1}^k x_i^2$を満たすとき，実体(real field)であるという．
\end{definition}

順序体と実体について，次の命題が成り立つ．

\begin{proposition}
     $F$を体とする．$F$が実体であることと，$F$が順序体となるような全順序構造$<$を持つことは同値である．
\end{proposition}

例えば，実数体$\R$や有理数体$\Q$は，通常の全順序構造を入れることにより順序体となる．したがって，$\R$および$\Q$は実体である．

\begin{definition}[実閉体の定義]
     実体$F$が実閉体(real closed field)であるとは，$F$の代数拡大で実体になるものは$F$自身に限ることである．
\end{definition}

\begin{theorem}[E. Artin]
     順序体$(F,<)$は，次の二つの性質を満たせば実閉体である．
     \begin{enumerate}
          \item 任意の$x \in F$に対し, $x>0$ならば$x = y^2$を満たす$y \in F$が存在する．
          \item 奇数次数の$F$係数$1$変数多項式は，$F$上に少なくとも$1$つの解を持つ．
     \end{enumerate}
\end{theorem}

この定理により，実閉体の理論は一階述語論理で公理化することができる．

例えば，実数体$\R$は実閉体である．
また，代数的数全体(すなわち, 有理数体$\Q$の代数的閉包)$\bar{\Q}$と実数体$\R$の共通部分$\Ralg := \bar{\Q} \cap \R$は実閉体である．
$\Ralg$に属する元を実代数的数という．

\subsection{一階述語論理}
一階述語論理式(first-order logic)は，
変数記号，論理記号 ($=, \lnot, \lor, \land, \rightarrow$), 量化記号($\forall, \exists$)
と，言語$L$で記述される．

ここで，言語$L$とは，述語記号，関数記号，定数記号からなる集合である．
ただし，各述語記号$R \in L$は，何個の変数を受け取るか定まっているものとし，
同様に各関数記号$f \in L$は，何個の変数を受け取るか定まっているものとする．
$n$個の変数を受け取る述語記号を$n$変数述語記号といい，$n$個の変数を受け取る関数記号を$n$変数関数記号という．

\begin{example}[順序環の言語]
     次の記号からなる言語$L_\mathrm{OR}$を，順序環の言語という．
     \begin{itemize}
          \item 2変数述語記号 $<$,
          \item 2変数関数記号 $+$, $\cdot$,
          \item 定数記号 $1$, $0$.
     \end{itemize}
\end{example}

言語$L$が定義されると，順に項，原子論理式，論理式が順に定義される．

\begin{definition}[項の定義]
     言語$L$に対して，項(term)が帰納的に定義される．
     \begin{enumerate}
          \item 変数記号，定数記号は項である．
          \item $t_1, \dots, t_n$がいずれも項とする．任意の$n$変数関数記号$f \in L$に対し，$f(t_1, \dots, t_n)$は項である．
          \item 以上の規則により定まる記号列のみが項である．
     \end{enumerate}
\end{definition}

\begin{definition}[論理式の定義]
     言語$L$に対して，原子論理式(atomic formula)を，次のいずれかの形をした記号列で定義する．
     \begin{enumerate}
          \item $t_1, t_2$を項として，$(t_1=t_2)$.
          \item $R \in L$を$n$変数述語記号，$t_1, \dots, t_n$を項として，$(R(t_1, \dots, t_n))$.
     \end{enumerate}
     
     さらに，言語$L$に対して，論理式(formula)が帰納的に定義される．
     \begin{enumerate}
          \item 原子論理式は論理式である．
          \item $\phi$が論理式であるとすると，$(\lnot \phi)$は論理式である．
          \item $\phi$,$\psi$が論理式であるとすると，$(\phi \lor \psi)$, $(\phi \land \psi)$, $(\phi \rightarrow \psi)$はいずれも論理式である．
          \item $\phi$が論理式であるとすると，任意の変数記号$x$に対して$(\forall x \phi)$, $(\exists x \phi)$は論理式である．
          \item 以上の規則により定まる記号列のみが論理式である．
     \end{enumerate}
\end{definition}

論理式$\phi := \forall x (x^2 + y > 0)$について観察する．ここで，$x,y$はいずれも変数記号である．

これは，「全ての$x$に対して$x^2 + y > 0$が成り立つ」というように読むことができるが，$y$の値は自由に設定することができ，$y$の値が定まらない限りは真であるか偽であるかははっきりしない．
この$y$のように，自由な状態にある変数記号を論理式$\phi$の自由変数といい，一方$x$のように自由な状態にない変数記号を論理式$\phi$の束縛変数という．

厳密には，次のように定義する．

\begin{definition}[自由変数の定義]
     言語$L$を一つとる．
     項$t$に登場する全ての変数記号を$\Var(t)$で表す．

     論理式$\phi$の自由変数(free variable)全体$\Var(\phi)$を，次のように論理記号及び量化記号の数に関して帰納的に定義する．
     \begin{enumerate}
          \item $t_1, t_2$を項とするとき，$\Var((t_1=t_2)):=\Var(t_1)\cup\Var(t_2)$と定義する．
          \item $R \in L$を$n$変数述語記号，$t_1, \dots, t_n$を項とするとき，$\Var(R(t_1, \dots, t_n)):= \bigcup_{i=1}^n \Var(t_i)$と定義する．
          \item 論理式$\phi$に対して$\Var(\phi)$が定義されているとき，$\Var((\lnot \phi)):=\Var(\phi)$と定義する．
          \item 論理式$\phi, \psi$に対して$\Var(\phi), \Var(\psi)$が定義されているとき，
          $\Var((\phi \lor \psi)):=\Var(\phi)\cup\Var(\psi)$,
          $\Var((\phi \land \psi)):=\Var(\phi)\cup\Var(\psi)$,
          $\Var((\phi \rightarrow \psi)):=\Var(\phi)\cup\Var(\psi)$
          と定義する．
          \item 論理式$\phi$に対して，$\Var(\phi)$が定義されているとき，変数記号$x$に対して
          $\Var((\forall x\phi)):=\Var(\phi) \setminus \{x\}$,
          $\Var((\exists x\phi)):=\Var(\phi) \setminus \{x\}$
          と定義する．
     \end{enumerate}

     論理式$\phi$に登場する自由変数が高々$x_1, \dots, x_n$である事を明示したいとき，$\phi(x_1, \dots, x_n)$と書く．ただし，登場しない自由変数があっても良い．

     項$t$が自由変数を持たないとき，すなわち$\Var(t)=\emptyset$であるとき，$t$を閉項(closed term)という．
     また，論理式$\phi$が自由変数を持たないとき，すなわち$\Var(\phi)=\emptyset$であるとき，$\phi$を閉論理式(closed formula)という．
\end{definition}

\begin{definition}[理論]
     言語$L$に対して，閉論理式からなる集合を理論(theory)という．
\end{definition}

\begin{example}[実閉体の理論]
     順序環の言語$L_\mathrm{OR}=\{<, +, \cdot, 1, 0\}$上の実閉体の理論$\RCF$を，次のように定義する．
     
     \begin{itemize}
          \item 体の公理
          \begin{enumerate}
               \item $\forall x \forall y(x + y = y + x)$
               \item $\forall x \forall y \forall z((x + y) + z = x + (y + z))$
               \item $\forall x (x + 0 = x)$
               \item $\forall x \exists y (x + y = 0)$
               \item $\forall x \forall y(x \cdot y = y \cdot x)$
               \item $\forall x \forall y \forall z((x \cdot y) \cdot z = x \cdot (y \cdot z))$
               \item $\forall x (x \cdot 1 = x)$
               \item $\forall x \exists y ((x=0) \lor (x \cdot y = 1))$
               \item $\lnot(0 = 1)$
          \end{enumerate}
          \item 全順序の公理
          \begin{enumerate}
               \item $\forall x (\lnot(x<x))$
               \item $\forall x \forall y \forall z((x < y \land y < z) \rightarrow x < z)$
               \item $\forall x \forall y (\lnot(x = y) \rightarrow (x<y \lor y<x))$
          \end{enumerate}
          \item 順序体の公理
          \begin{enumerate}
               \item $\forall x \forall y \forall z (x \leq y \rightarrow x + z \leq y + z)$
               \item $\forall x \forall y ((0 < x \land 0 < y) \rightarrow 0 < x \cdot y )$
          \end{enumerate}
          \item 実数体の公理
          \begin{enumerate}
               \item $\forall x \exists y (0<x \rightarrow x=y^2)$
               \item $\forall a_{2n-1} \dots \forall a_1 \forall a_0 \exists x(\lnot(a_{2n-1} = 0) \land (a_{2n-1}\cdot x^{2n-1} + \dots a_1 \cdot x + a_0 = 0)) \quad (n=1,2,\dots)$ 
          \end{enumerate}
     \end{itemize}

     ただし，項$t_1, t_2$に対し，$t_1 \leq t_2$は$(t_1 < t_2)\lor(t_1 = t_2)$の省略記号とする．
     また，項$t$と$n=1,2,\dots$に対し，$t^n$は，$t^n:=t \cdot t^{n-1}$, $t^1:=t$により帰納的に定義された省略記号とする．
\end{example}

理論$\RCF$の閉論理式をすべて満たすような数学的構造を，実閉体とよびたい．
このような定義を正当化させるには，この数学的構造が，言語$L_\mathrm{OR}$で書かれた閉論理式を真か偽か判定できることが必要である．
そのために，まず言語を解釈する数学的構造を定義する．

\begin{definition}[構造の定義]
     言語$L$の構造(structure)とは，空でない集合$M$と，次のようなデータの組$\M=(M,\dots)$である．
     \begin{itemize}
          \item 各$n$変数述語記号$R \in L$に対応する部分集合$R^\M \subset M^n$.
          \item 各$n$変数関数記号$f \in L$に対応する写像$\map{f^\M}{M^n}{M}$.
          \item 各定数記号$c \in L$に対応する元$c^\M \in M$.
     \end{itemize}
\end{definition}

言語$L$の構造$\M$が与えられたとき，
言語$L$上の論理式$\phi$が構造$\M$で成り立つかどうか，すなわち充足関係があるかどうかを定義できる．

\begin{definition}
     言語$L$上の構造$\M = (M,\dots)$をとる．
     言語$L$に形式的な定数記号$\{c_m \mid m \in M\}$を追加した言語を$L(\M)$とする．
     ここで，各$m \in M$に対し, $c_m^{\M}:=m$とすることで，
     $\M$は言語$L(\M)$の構造に拡張できる．
     \begin{itemize}
          \item $L(\M)$上の閉項$t$の解釈$t^\M$を帰納的に定義する．
          \begin{enumerate}
               \item $f$を$n$変数関数記号とし, 閉項$t_1$, \dots $t_n$のそれぞれの解釈$t_1^\M,\dots,t_n^\M$が定まっているとする．
               このとき，$(f(t_1,\dots,t_n))^\M:=f^\M(t_1^\M,\dots,t_m^\M)$と定める．
          \end{enumerate}
          \item $L(\M)$上の閉論理式$\phi$に対し, 充足関係(satisfaction relation)があること（$\M \models \phi$とかく）を帰納的に定義する．
          \begin{enumerate}
               \item $t_1,t_2$を$L(\M)$上の閉項とするとき, 
               \[
                    \M \models (t_1 = t_2) \defiff t_1^\M = t_2^\M,
               \]
               \item $t_1,\dots t_n$を$L(\M)$上の閉項，$R$を$n$変数述語記号とするとき，
               \[
                    \M \models (R(t_1, \dots, t_n)) \defiff (t_1^\M, \dots, t_n^\M) \in R^\M,
               \]
               \item $L(\M)$上の閉論理式$\phi$に対し
               \[
                    \M \models (\lnot \phi) \defiff \M \not\models \phi,
               \]
               \item $L(\M)$上の閉論理式$\phi, \psi$に対し
               \begin{align*}
                    &\M \models (\phi \lor \psi) \defiff \M \models \phi \text{または} \M \models \psi,\\
                    &\M \models (\phi \land \psi) \defiff \M \models \phi \text{かつ} \M \models \psi,\\
                    &\M \models (\phi \rightarrow \psi) \defiff \M \not\models \phi \text{または} \M \models \psi,
               \end{align*}
               \item $L(\M)$上の変数記号が高々$x$のみである論理式$\phi(x)$に対し
               \begin{align*}
                    &\M \models (\forall x \phi(x)) \defiff \text{任意の$m \in M$に対し}\M \models \phi(c_m),\\
                    &\M \models (\exists x \phi(x)) \defiff \text{ある$m \in M$に対し}\M \models\phi(c_m).
               \end{align*}
          \end{enumerate}
     \end{itemize}
\end{definition}

\begin{definition}
     $L$を言語とし，$T$を$L$上の理論とする．
     $L$上の構造$\M$が任意の$\phi \in T$に対して$\M\models \phi$であるとき，構造$\M$を$T$のモデル(model)といい，$\M \models T$とかく．
\end{definition}

言語$L_\mathrm{OR}$上の構造$\R=(\R,<,+,\cdot,1,0)$や$\Ralg=(\Ralg,<,+,\cdot,1,0)$は，いずれも実閉体である．したがって，
\[
     \R \models \RCF, \quad \Ralg \models \RCF
\]
であり，構造$\R$,$\Ralg$はいずれも実閉体の理論$\RCF$のモデルである．

\section{量化記号消去}
% 実閉体$R$をとる．多項式を考えるとき，係数体は$R$とする．

% 参考文献[Anai, QEの計算アルゴリズムとその応用]に乗っ取り用語を定義する．
% と思ったけど，モデル理論の用語を用いたほうが良さそうなので直す．

% \begin{definition}[代数的命題文]
%      代数的命題文を以下の条件で定義する．
%      \begin{enumerate}
%           \item 任意の多項式$f(x, y, \dots)$に対し, $f(x,y, \dots) > 0$, $f(x,y, \dots) = 0$, $f(x,y, \dots) < 0$は代数的命題文である.
%           \item $\phi_1, \phi_2$ が代数的命題文であるとき，$\phi_1 \lor \phi_2$, $\phi_1 \land \phi_2$は代数的命題文である．
%           \item $\phi$ が代数的命題文であるとき，$\lnot \phi$は代数的命題文である．
%           \item 上記の規則により生成される命題文だけが代数的命題文である．
%      \end{enumerate}
%      このとき，代数的命題文$\phi$に対し，$\phi$の自由変数が自然に定まる．明示的に自由変数を記述するときは，代数的命題文$\phi(x,y,\dots)$等とかく．
% \end{definition}

% \begin{definition}[タルスキー文]
%      タルスキー文を以下の条件で定義する．
%      \begin{enumerate}
%           \item 代数的命題文$\phi$はタルスキー文である．
%           \item $\phi(x,y,\dots)$がタルスキー文であるとき，$\exists x \in R \phi(x,y,\dots)$, $\forall x \in R \phi(x,y,\dots)$はタルスキー文である．
%           \item $\phi_1, \phi_2$ がタルスキー文であるとき，$\phi_1 \lor \phi_2$, $\phi_1 \land \phi_2$はタルスキー文である．
%           \item $\phi$ がタルスキー文であるとき，$\lnot \phi$はタルスキー文である．
%           \item 上記の規則により生成される命題文だけがタルスキー文である．
%      \end{enumerate}
%      このとき, タルスキー文$\phi$に対し，$\phi$の自由変数が自然に定まる．明示的に自由変数を記述するときは, タルスキー文$\phi(x, y, \dots)$等とかく． 
% \end{definition}

% この節では，実閉体の理論$\RCF$が量化記号消去可能であることについて述べる．

\begin{example}
     言語$L_\mathrm{OR}$上の次のような論理式を考える．
     \begin{equation*}
          \phi(a) := \forall (x^2 + ax + a + 3 > 0)
     \end{equation*}

     簡単のため，実閉体のモデルである実数体$\R$をとって考える．すなわち，上記の論理式は次のように言い換えられる．
     \begin{equation*}
          \text{全ての実数$x \in \R$に対して} x^2 + ax + a + 3 > 0
     \end{equation*}
     これを，変数記号$a$についての条件と解釈すると，2次方程式$x^2 + ax + a + 3 = 0$の判別式が0より大きいことに必要十分であるから，
     \begin{equation*}
          \psi(a) := (a < -2) \lor (6 < a)
     \end{equation*}
     に同値である．すなわち，次が成り立つ．
     \begin{equation*}
          \R \models \forall a (\phi(a) \leftrightarrow \psi(a)).
     \end{equation*}
\end{example}

上記の例は，実数体$\R$についてのみ考察しているが，実は，全ての$\RCF$のモデル$R$に対して
\begin{equation*}
     R \models \forall a (\phi(a) \leftrightarrow \psi(a))
\end{equation*}
が成り立つ．ここで，$\phi$には束縛変数$x$が現れており，一方で$\psi$に登場する変数記号は全て自由変数である．
つまり，$\phi$に登場する量化記号を消去し，自由変数のみの論理式$\psi$で記述できている．このような現象を扱うために，「量化記号を消去する」概念を定義する．


\begin{definition}
$T$を言語$L$上の理論とし，$\phi$を$L$上の論理式とする．% semantic consequences じゃないの？ vs syntax consequences
全ての$T$のモデル$\M$に対して$\M \models \phi$が成り立つとき，$\phi$は$T$の論理的帰結(logical consequences)であるといい，$T \models \phi$とかく．

理論$T$で量化記号消去(quantifier elimination)ができるとは，
$L$上の任意の論理式$\phi(x_1,\dots,x_n)$に対し，量化記号を含まない論理式$\psi(x_1,\dots, x_n)$が存在し，
\begin{equation*}
     T \models \forall x_1 \dots \forall x_n(\phi(x_1,\dots,x_n) \leftrightarrow \psi(x_1, \dots, x_n))
\end{equation*}
が成り立つことと定義する．
\end{definition}

以下では量化記号を含まない論理式を，$\Delta_0$-論理式とよぶことにする．

実は，実閉体の理論は量化記号消去ができることが示されている．すなわち，次が成り立つ．

\begin{theorem}(Tarski-Seidenberg)
     実閉体の理論$\RCF$は量化記号消去ができる．
\end{theorem}

しかし，上記の定理は，任意の論理式が与えられたとき，それに同値な$\Delta_0$-論理式を導出する手続きを示しているわけではない．
よりアルゴリズミックに導出する手続きとして，Collinsにより提唱された柱状代数分解による量化記号消去の方法が知られている．

この方法は，次のような形式で与えられた論理式
\begin{equation*}
     \Qua_1 y_1 \Qua_2 y_2 \dots \Qua_k y_k \psi(x_1, \dots, x_n, y_1, \dots, y_k)
\end{equation*}
に対して同値な$\Delta_0$-論理式を求める手続きを与えている．
ここで，$\Qua_i \in \{\exists, \forall\}$であり, $\psi(x_1, \dots, x_n, y_1, \dots, y_k)$は$\Delta_0$-論理式である． 

次の節では，その柱状代数分解について解説する．


\section{柱状代数分解}
% この節はまだEuclid空間(実数体)で書いているので訂正する．

柱状代数分解とは，ユークリッド空間の分割で，各分割の上で複数の多項式を符号不変にするものである．Collinsにより提唱されたCADアルゴリズムについてかく．
\begin{definition}
$\R^n$の有限部分集合族$\mathfrak{D}$が，

\begin{itemize}
	\item 任意の$D \in \mathfrak{D}$は空でない弧状連結集合，
	\item 任意の$D_1$, $D_2 \in \mathfrak{D}$について，$D_1 \neq D_2$ならば$D_1 \cap D_2 = \emptyset$,
	\item $\bigcup_{D \in \mathfrak{D}}D = \R^n$
\end{itemize}

を満たすとき，$\mathfrak{D}$を$\R^n$の分割という．
\end{definition}

\begin{definition}
$F \subset \R[x_1, \dots, x_n]$を有限部分集合とする．

$D \subset \R^n$が$F$符号不変であるとは，任意の$f \in F$に対し，$f$の符号が$D$上一定であることと定義する．

さらに，$\R^n$の分割$\mathfrak{D}$が，任意の$D \in \mathfrak{D}$に対して，$D$が$F$符号不変となるとき，$\mathfrak{D}$を$\R^n$の$F$符号不変な分割という．
\end{definition}

\subsection{描画可能}
\begin{definition}
$F \subset \R^n[x_1, \dots, x_n]$を有限部分集合とする．空でない弧状連結部分集合$S \subset \R^{n-1}$が$F$描画可能であるとは，
\begin{itemize}
	\item 任意の$ x \in S $に対し，$ F $の解の個数，すなわち$ \{y \in \mathbb{R} \mid \text{ある$f \in F$に対し$f(x,y) = 0$} \} $の元の個数が一定であり，
	\item 各$ x \in S $の$F$の解を$ f_1(x) < f_2(x) < \dots < f_k(x) $と書くとき，各$ f_i $は$ S $上の実数値連続関数
\end{itemize}
であることと定義する．
\end{definition}

\begin{proposition}\label{proposition:del}
$S \subset \R^{n-1}$を空でない弧状連結部分集合とし，$F \subset \R[x_1, \dots, x_n]$を有限部分集合とする．
次の3条件を満たすとき，$S$は$F$描画可能である．
\begin{itemize}
     \item 任意の$f \in F$に対し，$S$上$f$の複素数根の数は重複度込みで一定である．
     \item 任意の$f \in F$に対し，$S$上$f$の相異なる複素数根の数は一定である．
     \item 相異なる任意の$f, g \in F$に対し，$S$上$f$, $g$に共通する複素数根の数は重複度込みで一定である．
\end{itemize}
\end{proposition}

この命題を示すために次の二つの補題を用意する．

\begin{lemma}\label{lemma:del_1}
$S \subset \R^{n-1}$を空でない弧状連結部分集合とし，$f_1$, $f_2 \in \R[x_1, \dots, x_n]$が次を満たすとする.
\begin{itemize}
\item 各$i=1, 2$に対し，$S$上$f_i$の重複度込みの複素数根の数は一定．
\item 各$i=1, 2$に対し，$S$上$f_i$の相異なる複素数根の数は一定．
\item $S$上$f_1, f_2$の重複度込みの複素数共通根の数は一定．
\end{itemize}
このとき，$S$上$f_1$, $f_2$の相異なる複素数共通根の数は一定．
\end{lemma}
\begin{proof}
方針: $S_k = \{a \in S \mid \text{$f_1(a)$, $f_2(a)$の相異なる複素数共通根がk個} \}$が開集合であることを示す．（多項式の解の，係数についての連続性から示せる．）

\end{proof}

\begin{lemma}\label{lemma:del_2}
$A \in \R[x_1, \dots, x_n]$とし，$S \subset \R^{n-1}$を弧状連結部分集合とする．
\begin{itemize}
\item $S$上$A$の重複度込みの複素数根の数は一定．
\item $S$上$A$の相異なる複素数根の数は一定．
\end{itemize}
このとき，$S$は$\{A\}$描画可能である．
\end{lemma}

\begin{proof}
方針:次の二つのことを示さなければならない．\\
1.  $S$上実根の数は一定．\\
2.  $S$上実根は連続である．\\
いずれも多項式の根の係数に対する連続性から示せる．
\end{proof}

\begin{proof}[{\bf \cref{proposition:del}の証明}]
\cref{lemma:del_2}より，各$f \in F$に対して，$S$は$\{f\}$描画可能である．
よって，$S$上の連続関数$\alpha_{1,f}(a) < \dots \alpha_{n_f, f}(a)$を，各$a \in S$で$f(a)(x) \in \R[x]$の解であるようにとれる．

\begin{claim*}
$f, g \in F$が，$f \neq g$であるとする．
ある$a \in S$において$\alpha_{k,f}(a) = \alpha_{l,g}(a)$であるならば，任意の$a \in S$に対して$\alpha_{k,f}(a) = \alpha_{l,g}(a)$である．
\end{claim*}

この主張は，$S$が弧状連結であることと，\cref{lemma:del_1}から従う．
この主張より，$F$の解の個数は$S$上一定である．よって，命題が示された．
\end{proof}

\begin{corollary}\label{corollary:del}
$S \subset \R^{n-1}$を弧状連結部分集合とし，$F \subset \R[x_1,\dots, x_n]$を有限部分集合とする．
次が成り立つとき，$S$は$F$描画可能である．
\begin{itemize}
\item 任意の$f \in F$に対し，$\deg(f(a))$が一定（$a \in S$）．
\item 任意の$f \in F$に対し，$\deg(\gcd(f(a), \frac{\partial f}{\partial x_n}(a)))$が一定（$a \in S$）．
\item 任意の$f, g \in F$に対し，$\deg(\gcd(f(a), g(a)))$が一定（$a \in S$）．
\end{itemize}
\end{corollary}

よって，$F$符号不変な$\R^n$の分割を与えるには，\cref{corollary:del}の条件を満たすような$\R^{n-1}$の分割を構成すればよい．
一つ目の条件を満たすような$\R^{n-1}$の分割を与えるには，各$f \in F$について，$x_n$係数が符号不変になるような分割を構成すればよい．
しかし，二つ目と三つ目の条件を満たすような$\R^{n-1}$の分割を与えるのは少し難しい．
なぜなら，多項式$f, g \in \R[x_1, \dots, x_n]$について，$a \in \R^{n-1}$を固定したとき，$\gcd(f,g)(a)$と$\gcd(f(a),g(a))$は必ずしも等しくないからである．

よって，二つ目と三つ目の条件も満たすような$\R^{n-1}$の分割を与えることができるように次の節で準備をする．



\subsection{主部分終結式係数(Principal Subresultant Coefficient)}

\begin{definition}
$\mathrm{R}$を可換環とし，$A(x), B(x) \in \mathrm{R}[x]$ を，$\deg A(x) = m$, $\deg B(x) = n$ とする．ただし，$\deg 0 = 0$と解釈する．

$j = 0, \dots, \min\{n, m\}$に対し，多項式$A(x)$, $B(x)$の$j$次部分終結式$S_j(A, B)$を次のように定義する．
\begin{align*}
A(x) = a_m x^m + \dots + a_1 x + a_0, \\
B(x) = b_n x^n + \dots + b_1 x + b_0 
\end{align*}
として，$j = 0, \dots, \min\{n,m\}$に対し，
\begin{align*}
M_j = 
\begin{pmatrix}
a_m & a_{m-1} & \cdots & a_1 & a_0 &    &  \\
     &  a_m     & \cdots & a_2 & a_1& a_0 &  \\
     &   & \ddots &  & & \\
b_n & b_{n-1} & \cdots & b_1 & b_0 &    & \\
     &  b_n     & \cdots & b_2 & b_1& b_0 & \\
     &   & \ddots &  & & 
\end{pmatrix}
\in \mathrm{M}_{m+n-2j, m+n-j}(\mathrm{R})
\end{align*}
とする．ここで，行列の空白部分はすべて$0$であり，また，行列の上側は$n-j$行，行列の下側は$m-j$行である．

また，$j = 0, \dots, \min\{m,n\}$, $i = 0, \dots, j$に対し，
\begin{align*}
M_{j,i} = (\text{$M_j$の第$1$列}, \text{$M_j$の第$2$列}, \dots ,\text{$M_j$の第$m+n-2j-1$列}, \text{$M_j$の第$m+n-i-j$列})
\in \mathrm{M}_{m+n-2j, m+n-2j}(\mathrm{R})
\end{align*}
とする．$j = 0, \dots, \min\{n, m\}$に対し，
\begin{align*}
S_j(A, B) = \sum_{i=0}^j \det M_{j, i} \cdot x^i 
\end{align*}
を多項式$A(x)$, $B(x)$の$j$次部分終結式$S_j(A, B)$という．

この$j$次部分終結式の先頭項係数を，$\psc_j(A,B)$とかき，多項式$A(x)$, $B(x)$の$j$次主部分終結式係数という．
\end{definition}


主部分終結式係数は，多項式$A(x)$, $B(x)$の係数，及び次数に依存して定まる．

\begin{remark}
$m$, $n$のどちらかが$0$のとき，
$S_0(A,B) = 0$, $\psc_0(A,B) = 0$とする．

また，$\psc_0(A,B)$は，多項式$A(x)$, $B(x)$の終結式に一致する．
\end{remark}

\begin{proposition}\label{proposition:psc}
$\mathrm{R}$を体とし，$A(x), B(x) \in \mathrm{R}[x] \setminus \{0\}$とすると，次が成立する．
\begin{align*}
\deg(\gcd(A, B)) = \min \{ j  \in \{0,1, \dots, \min\{n,m\}\}\mid \psc_j(A,B) \neq 0\}
\end{align*}
\end{proposition}

\begin{proof}
後で書く．
方針: 部分終結式がユークリッドの互除法で出てくる多項式の列の定数倍になることが分かる．


\end{proof}


\subsection{符号不変な分割の存在とCADアルゴリズム}
\begin{definition}
$F \subset \R[x_1, \dots, x_n]$を有限部分集合とする．$\PROJ(F) \subset \R[x_1, \dots, x_{n-1}]$を，次のように定める．

まず，$B(F) := \{ \mathrm{red}^k(f) \mid f \in F, k=1, \dots, \deg(f) \}$とする．ただし，$\mathrm{red}(f) = f - \mathrm{LT}(f; x_n)$である．
次に，
\begin{align*}
	\PROJ_1(F) &:= \{\mathrm{LC}(f;x_n) \mid f \in B\},\\
	\PROJ_2(F) &:= \{\psc_j(f, \frac{\partial f}{\partial x_n}; x_n) \mid f \in B, j =0, \dots, \deg(\frac{\partial f}{\partial x_n};x_n) \},\\
	\PROJ_3(F) &:= \{\psc_j(f,g;x_n) \mid f,g \in B, j = 0, \dots, \min\{\deg(f;x_n), \deg(g;x_n)\}\}
\end{align*}
とし，以上を用いて
\begin{align*}
	\PROJ(F) &:= \PROJ_1(F) \cup \PROJ_2(F) \cup \PROJ_3(F)
\end{align*}
と定める．
\end{definition}
\begin{corollary}
$F \subset \R[x_1, \dots, x_n]$を有限部分集合とし，$S \subset \R^{n-1}$を弧状連結部分集合とする．

$S$が$\PROJ(F)$符号不変ならば，$S$は$F$描画可能である．
\end{corollary}

\begin{proof}
\cref{proposition:del}及び\cref{proposition:psc}から従う．
\end{proof}

\begin{definition}
$ F \subset \mathbb{R}[x_1,\dots,x_n] $ を有限部分集合とする．$ S \subset \mathbb{R}^{n-1} $が$ F $描画可能とする．
このとき，$ S $上の$ F $の解を$ f_1(x)< \dots <f_k(x) $とし，$ f_0(x) := -\infty $ , $ f_{k+1}(x) := \infty $とするとき，
\begin{align*}
  C_{2i} &:= \{(x,y) \mid  x \in S, f_i(x) = y \} \quad i = 1,\dots, k,\\
  C_{2i+1} &:= \{(x,y) \mid x \in S, f_{i}(x)<y<f_{i+1}(x) \} \quad i = 0,1, \dots, k 
\end{align*}

とすれば，$\{C_j\}_{j=1}^{2k+1}$は$ S \times \mathbb{R} $の$F$符号不変な分割を与える．
この$ S \times \mathbb{R} $の分割$ \{C_j\}_{j=1}^{2k+1} $を，$ S $の持ち上げといい，$ \mathfrak{L}(S) $と書く．

また，$\mathfrak{D}$が$\R^{n-1}$の分割であるとき，$\mathfrak{L}(\mathfrak{D}) := \bigcup_{D \in \mathfrak{D}}\mathfrak{L}(D)$を$\mathfrak{D}$の持ち上げという．
\end{definition}

以上より，有限部分集合$F \subset \R[x_1, \dots, x_n]$が与えられたとき，$F$の符号不変な分割を取得するアルゴリズムは次のように表現される．

\begin{algorithm}
    \caption{CADアルゴリズム}
    \begin{algorithmic}[1]
    \REQUIRE $n \geq 1$: 自然数，$F \subset \R[x_1, \dots, x_n]$: 有限部分集合
    \ENSURE $\mathfrak{D}$: $\R^n$の$F$符号不変な分割
    \STATE $\mathfrak{D} \leftarrow \text{$\PROJ^{n-1}(F)$-符号不変な$\R^1$の分割}$
    \STATE $k \leftarrow 1$
    \WHILE{$k < n$}
    \STATE $\mathfrak{D} \leftarrow \text{$\mathfrak{L}(\mathfrak{D})$: $\mathfrak{D}$の持ち上げ}$
    \STATE $k \leftarrow k+1$
    \ENDWHILE
    \end{algorithmic}
\end{algorithm}

このアルゴリズムを実際にコンピュータ上に実装するには，$\R^n$の分割でなく，分割の各セルから代表元を取得したものを得る．
\section{QEとCADアルゴリズム}
有限部分集合$F \subset \R[x_1, \dots, x_n]$が与えられたとき，
前節では$\R^n$の$F$符号不変な分割$\mathfrak{D}$を構成することができることを示した．
実はこのCADアルゴリズムによる分割は半代数的集合となっているのだが，各セルの定義式がどのようになっているかは記述できていない．
量化記号消去を行うには実際に各セル$D \in \mathfrak{D}$について，$D$の定義式が必要である．

そのため，まず始めに定義式まで明示できるようにCADアルゴリズムを改良する．

\subsection{増補射影}

\begin{definition}
     次数$m$の実係数多項式$f(x) \in \R[x] \setminus \{0\}$に対し，
     \begin{align*}
          F_0(x) &:= f(x),\\
          F_i(x) &:= \frac{d^i f}{dx^i}(x) \quad i = 1, \dots, m
     \end{align*}
     とする．この多項式の列$\{F_i\}_{i=0}^m$を，$f(x)$のフーリエ列という．
\end{definition}

\begin{theorem}[トムの補題]
     次数$m$の実係数多項式$f(x) \in \R[x] \setminus \{0\}$をとる．
     このとき，各$\sigma \in \{-1, 0, +1\}^{m+1}$に対して，
     \begin{align*}
          \mathfrak{R}_f(\sigma) := \{x \in \R \mid \sign(F_i(x)) = \sigma_i, \, i = 1, \dots, m \}
     \end{align*}
     とすると, $\mathfrak{R}_f(\sigma)$は空集合，一点からなる集合，開区間のいずれかである．
\end{theorem}

\begin{proof}
     後で書く．帰納法で示せる．
\end{proof}


\begin{thebibliography}{9}
     \bibitem{Arai} 新井敏康，『数学基礎論』，岩波書店(2016)
     \bibitem{Itai} 板井昌典, 『モデル理論』, 森北出版(2023)
\end{thebibliography}

\end{document}