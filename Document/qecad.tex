\documentclass[uplatex, dvipdfmx]{jsarticle}

\usepackage{amsmath,amssymb}
\usepackage{amsthm}
\usepackage{algorithmic}
\usepackage{algorithm}
\usepackage{cleveref}

\newcommand{\R}{\mathbb{R}}
\newcommand{\Qua}{\mathfrak{Q}}
\newcommand{\psc}{\mathrm{psc}}
\newcommand{\PROJ}{\mathrm{PROJ}}
\newcommand{\sign}{\mathrm{sign}}

\theoremstyle{definition}
\newtheorem{definition}{定義}[section]
\crefname{definition}{定義}{定義}%
\newtheorem{proposition}{命題}[section]
\crefname{proposition}{命題}{命題}%
\newtheorem{lemma}{補題}[section]
\crefname{lemma}{補題}{補題}%
\newtheorem{theorem}{定理}[section]
\crefname{theorem}{定理}{定理}%
\newtheorem{corollary}{系}[section]
\crefname{corollary}{系}{系}%S
\newtheorem*{claim*}{主張}
\newtheorem{remark}{注意}[section]
\newtheorem{example}{例}[section]

\renewcommand{\proofname}{\textbf{証明}}

\begin{document}

\title{実閉体上の柱状代数分解による量化子消去}
\author{富永 直弥}
\maketitle

\section{量化子消去}
実閉体$R$をとる．多項式を考えるとき，係数体は$R$とする．

% 参考文献[Anai, QEの計算アルゴリズムとその応用]に乗っ取り用語を定義する．

\begin{definition}
     代数的命題文を以下の条件で定義する．
     \begin{enumerate}
          \item 任意の多項式$f(x, y, \dots)$に対し, $f(x,y, \dots) > 0$, $f(x,y, \dots) = 0$, $f(x,y, \dots) < 0$は代数的命題文である.
          \item $\phi_1, \phi_2$ が代数的命題文であるとき，$\phi_1 \lor \phi_2$, $\phi_1 \land \phi_2$は代数的命題文である．
          \item $\phi$ が代数的命題文であるとき，$\lnot \phi$は代数的命題文である．
          \item 上記の規則により生成される命題文だけが代数的命題文である．
     \end{enumerate}
     このとき，代数的命題文$\phi$に対し，$\phi$の自由変数が自然に定まる．明示的に自由変数を記述するときは，代数的命題文$\phi(x,y,\dots)$等とかく．
\end{definition}

\begin{definition}
     タルスキー文を以下の条件で定義する．
     \begin{enumerate}
          \item 代数的命題文$\phi$はタルスキー文である．
          \item $\phi(x,y,\dots)$がタルスキー文であるとき，$\exists x \in R \phi(x,y,\dots)$, $\forall x \in R \phi(x,y,\dots)$はタルスキー文である．
          \item $\phi_1, \phi_2$ がタルスキー文であるとき，$\phi_1 \lor \phi_2$, $\phi_1 \land \phi_2$はタルスキー文である．
          \item $\phi$ がタルスキー文であるとき，$\lnot \phi$はタルスキー文である．
          \item 上記の規則により生成される命題文だけがタルスキー文である．
     \end{enumerate}
     このとき, タルスキー文$\phi$に対し，$\phi$の自由変数が自然に定まる．明示的に自由変数を記述するときは, タルスキー文$\phi(x, y, \dots)$等とかく． 
\end{definition}

\begin{example}
     次のタルスキー文に対して同値な代数的命題文が存在する．
     \begin{equation*}
          \forall x \in \R (x^2 + ax + a + 3 > 0)
     \end{equation*}

     実際, $a$についての条件は，2次方程式$x^2 + ax + a + 3 = 0$の判別式が0より大きいことに必要十分であるから，上記のタルスキー文は，代数的命題文
     \begin{equation*}
          (a < -1) \lor (1 < a)
     \end{equation*}
     に同値である．
\end{example}


\begin{definition}
上記の例のように，タルスキー文と同値な代数的命題文を導出する手続きを量化子消去という．
また，タルスキー文$\phi$に対し，同値な代数的命題文が存在するとき，タルスキー文$\phi$は量化子消去可能という．
\end{definition}

実は，実閉体上の任意のタルスキー文は量化子消去可能であることが示されている．すなわち，次が成り立つ．

\begin{theorem}(Tarski-Seidenberg)
     任意のタルスキー文$\phi$に対し，$\phi$と同値な代数的命題文$\psi$が存在する．
\end{theorem}

しかし，上記の定理は，任意のタルスキー文が与えられたとき，それに同値な代数的命題文を導出する手続きを示しているわけではない．
よりアルゴリズミックに導出する手続きとして，Collinsにより提唱された柱状代数分解による量化子消去の方法が知られている．

この方法は，次のような形式で与えられたタルスキー文
\begin{equation*}
     \Qua_1 y_1 \Qua_2 y_2 \dots \Qua_k y_k \psi(x_1, \dots, x_n, y_1, \dots, y_k)
\end{equation*}
に対して同値な代数的命題文を求める手続きを与えている．
ここで，$\Qua_i \in \{\exists, \forall\}$であり, $\psi(x_1, \dots, x_n, y_1, \dots, y_k)$は代数的命題文である． 

次の節では，その柱状代数分解について解説する．


% この節はまだEuclid空間(実数体)で書いているので訂正する．
\section{柱状代数分解}
柱状代数分解とは，ユークリッド空間の分割で，各分割の上で複数の多項式を符号不変にするものである．Collinsにより提唱されたCADアルゴリズムについてかく．
\begin{definition}
$\R^n$の有限部分集合族$\mathfrak{D}$が，

\begin{itemize}
	\item 任意の$D \in \mathfrak{D}$は空でない弧状連結集合，
	\item 任意の$D_1$, $D_2 \in \mathfrak{D}$について，$D_1 \neq D_2$ならば$D_1 \cap D_2 = \emptyset$,
	\item $\bigcup_{D \in \mathfrak{D}}D = \R^n$
\end{itemize}

を満たすとき，$\mathfrak{D}$を$\R^n$の分割という．
\end{definition}

\begin{definition}
$F \subset \R[x_1, \dots, x_n]$を有限部分集合とする．

$D \subset \R^n$が$F$符号不変であるとは，任意の$f \in F$に対し，$f$の符号が$D$上一定であることと定義する．

さらに，$\R^n$の分割$\mathfrak{D}$が，任意の$D \in \mathfrak{D}$に対して，$D$が$F$符号不変となるとき，$\mathfrak{D}$を$\R^n$の$F$符号不変な分割という．
\end{definition}

\subsection{描画可能}
\begin{definition}
$F \subset \R^n[x_1, \dots, x_n]$を有限部分集合とする．空でない弧状連結部分集合$S \subset \R^{n-1}$が$F$描画可能であるとは，
\begin{itemize}
	\item 任意の$ x \in S $に対し，$ F $の解の個数，すなわち$ \{y \in \mathbb{R} \mid \text{ある$f \in F$に対し$f(x,y) = 0$} \} $の元の個数が一定であり，
	\item 各$ x \in S $の$F$の解を$ f_1(x) < f_2(x) < \dots < f_k(x) $と書くとき，各$ f_i $は$ S $上の実数値連続関数
\end{itemize}
であることと定義する．
\end{definition}

\begin{proposition}\label{proposition:del}
$S \subset \R^{n-1}$を空でない弧状連結部分集合とし，$F \subset \R[x_1, \dots, x_n]$を有限部分集合とする．
次の3条件を満たすとき，$S$は$F$描画可能である．
\begin{itemize}
     \item 任意の$f \in F$に対し，$S$上$f$の複素数根の数は重複度込みで一定である．
     \item 任意の$f \in F$に対し，$S$上$f$の相異なる複素数根の数は一定である．
     \item 相異なる任意の$f, g \in F$に対し，$S$上$f$, $g$に共通する複素数根の数は重複度込みで一定である．
\end{itemize}
\end{proposition}

この命題を示すために次の二つの補題を用意する．

\begin{lemma}\label{lemma:del_1}
$S \subset \R^{n-1}$を空でない弧状連結部分集合とし，$f_1$, $f_2 \in \R[x_1, \dots, x_n]$が次を満たすとする.
\begin{itemize}
\item 各$i=1, 2$に対し，$S$上$f_i$の重複度込みの複素数根の数は一定．
\item 各$i=1, 2$に対し，$S$上$f_i$の相異なる複素数根の数は一定．
\item $S$上$f_1, f_2$の重複度込みの複素数共通根の数は一定．
\end{itemize}
このとき，$S$上$f_1$, $f_2$の相異なる複素数共通根の数は一定．
\end{lemma}
\begin{proof}
方針: $S_k = \{a \in S \mid \text{$f_1(a)$, $f_2(a)$の相異なる複素数共通根がk個} \}$が開集合であることを示す．（多項式の解の，係数についての連続性から示せる．）

\end{proof}

\begin{lemma}\label{lemma:del_2}
$A \in \R[x_1, \dots, x_n]$とし，$S \subset \R^{n-1}$を弧状連結部分集合とする．
\begin{itemize}
\item $S$上$A$の重複度込みの複素数根の数は一定．
\item $S$上$A$の相異なる複素数根の数は一定．
\end{itemize}
このとき，$S$は$\{A\}$描画可能である．
\end{lemma}

\begin{proof}
方針:次の二つのことを示さなければならない．\\
1.  $S$上実根の数は一定．\\
2.  $S$上実根は連続である．\\
いずれも多項式の根の係数に対する連続性から示せる．
\end{proof}

\begin{proof}[{\bf \cref{proposition:del}の証明}]
\cref{lemma:del_2}より，各$f \in F$に対して，$S$は$\{f\}$描画可能である．
よって，$S$上の連続関数$\alpha_{1,f}(a) < \dots \alpha_{n_f, f}(a)$を，各$a \in S$で$f(a)(x) \in \R[x]$の解であるようにとれる．

\begin{claim*}
$f, g \in F$が，$f \neq g$であるとする．
ある$a \in S$において$\alpha_{k,f}(a) = \alpha_{l,g}(a)$であるならば，任意の$a \in S$に対して$\alpha_{k,f}(a) = \alpha_{l,g}(a)$である．
\end{claim*}

この主張は，$S$が弧状連結であることと，\cref{lemma:del_1}から従う．
この主張より，$F$の解の個数は$S$上一定である．よって，命題が示された．
\end{proof}

\begin{corollary}\label{corollary:del}
$S \subset \R^{n-1}$を弧状連結部分集合とし，$F \subset \R[x_1,\dots, x_n]$を有限部分集合とする．
次が成り立つとき，$S$は$F$描画可能である．
\begin{itemize}
\item 任意の$f \in F$に対し，$\deg(f(a))$が一定（$a \in S$）．
\item 任意の$f \in F$に対し，$\deg(\gcd(f(a), \frac{\partial f}{\partial x_n}(a)))$が一定（$a \in S$）．
\item 任意の$f, g \in F$に対し，$\deg(\gcd(f(a), g(a)))$が一定（$a \in S$）．
\end{itemize}
\end{corollary}

よって，$F$符号不変な$\R^n$の分割を与えるには，\cref{corollary:del}の条件を満たすような$\R^{n-1}$の分割を構成すればよい．
一つ目の条件を満たすような$\R^{n-1}$の分割を与えるには，各$f \in F$について，$x_n$係数が符号不変になるような分割を構成すればよい．
しかし，二つ目と三つ目の条件を満たすような$\R^{n-1}$の分割を与えるのは少し難しい．
なぜなら，多項式$f, g \in \R[x_1, \dots, x_n]$について，$a \in \R^{n-1}$を固定したとき，$\gcd(f,g)(a)$と$\gcd(f(a),g(a))$は必ずしも等しくないからである．

よって，二つ目と三つ目の条件も満たすような$\R^{n-1}$の分割を与えることができるように次の節で準備をする．



\subsection{主部分終結式係数(Principal Subresultant Coefficient)}

\begin{definition}
$\mathrm{R}$を可換環とし，$A(x), B(x) \in \mathrm{R}[x]$ を，$\deg A(x) = m$, $\deg B(x) = n$ とする．ただし，$\deg 0 = 0$と解釈する．

$j = 0, \dots, \min\{n, m\}$に対し，多項式$A(x)$, $B(x)$の$j$次部分終結式$S_j(A, B)$を次のように定義する．
\begin{align*}
A(x) = a_m x^m + \dots + a_1 x + a_0, \\
B(x) = b_n x^n + \dots + b_1 x + b_0 
\end{align*}
として，$j = 0, \dots, \min\{n,m\}$に対し，
\begin{align*}
M_j = 
\begin{pmatrix}
a_m & a_{m-1} & \cdots & a_1 & a_0 &    &  \\
     &  a_m     & \cdots & a_2 & a_1& a_0 &  \\
     &   & \ddots &  & & \\
b_n & b_{n-1} & \cdots & b_1 & b_0 &    & \\
     &  b_n     & \cdots & b_2 & b_1& b_0 & \\
     &   & \ddots &  & & 
\end{pmatrix}
\in \mathrm{M}_{m+n-2j, m+n-j}(\mathrm{R})
\end{align*}
とする．ここで，行列の空白部分はすべて$0$であり，また，行列の上側は$n-j$行，行列の下側は$m-j$行である．

また，$j = 0, \dots, \min\{m,n\}$, $i = 0, \dots, j$に対し，
\begin{align*}
M_{j,i} = (\text{$M_j$の第$1$列}, \text{$M_j$の第$2$列}, \dots ,\text{$M_j$の第$m+n-2j-1$列}, \text{$M_j$の第$m+n-i-j$列})
\in \mathrm{M}_{m+n-2j, m+n-2j}(\mathrm{R})
\end{align*}
とする．$j = 0, \dots, \min\{n, m\}$に対し，
\begin{align*}
S_j(A, B) = \sum_{i=0}^j \det M_{j, i} \cdot x^i 
\end{align*}
を多項式$A(x)$, $B(x)$の$j$次部分終結式$S_j(A, B)$という．

この$j$次部分終結式の先頭項係数を，$\psc_j(A,B)$とかき，多項式$A(x)$, $B(x)$の$j$次主部分終結式係数という．
\end{definition}


主部分終結式係数は，多項式$A(x)$, $B(x)$の係数，及び次数に依存して定まる．

\begin{remark}
$m$, $n$のどちらかが$0$のとき，
$S_0(A,B) = 0$, $\psc_0(A,B) = 0$とする．

また，$\psc_0(A,B)$は，多項式$A(x)$, $B(x)$の終結式に一致する．
\end{remark}

\begin{proposition}\label{proposition:psc}
$\mathrm{R}$を体とし，$A(x), B(x) \in \mathrm{R}[x] \setminus \{0\}$とすると，次が成立する．
\begin{align*}
\deg(\gcd(A, B)) = \min \{ j  \in \{0,1, \dots, \min\{n,m\}\}\mid \psc_j(A,B) \neq 0\}
\end{align*}
\end{proposition}

\begin{proof}
後で書く．
方針: 部分終結式がユークリッドの互除法で出てくる多項式の列の定数倍になることが分かる．


\end{proof}


\subsection{符号不変な分割の存在とCADアルゴリズム}
\begin{definition}
$F \subset \R[x_1, \dots, x_n]$を有限部分集合とする．$\PROJ(F) \subset \R[x_1, \dots, x_{n-1}]$を，次のように定める．

まず，$B(F) := \{ \mathrm{red}^k(f) \mid f \in F, k=1, \dots, \deg(f) \}$とする．ただし，$\mathrm{red}(f) = f - \mathrm{LT}(f; x_n)$である．
次に，
\begin{align*}
	\PROJ_1(F) &:= \{\mathrm{LC}(f;x_n) \mid f \in B\},\\
	\PROJ_2(F) &:= \{\psc_j(f, \frac{\partial f}{\partial x_n}; x_n) \mid f \in B, j =0, \dots, \deg(\frac{\partial f}{\partial x_n};x_n) \},\\
	\PROJ_3(F) &:= \{\psc_j(f,g;x_n) \mid f,g \in B, j = 0, \dots, \min\{\deg(f;x_n), \deg(g;x_n)\}\}
\end{align*}
とし，以上を用いて
\begin{align*}
	\PROJ(F) &:= \PROJ_1(F) \cup \PROJ_2(F) \cup \PROJ_3(F)
\end{align*}
と定める．
\end{definition}
\begin{corollary}
$F \subset \R[x_1, \dots, x_n]$を有限部分集合とし，$S \subset \R^{n-1}$を弧状連結部分集合とする．

$S$が$\PROJ(F)$符号不変ならば，$S$は$F$描画可能である．
\end{corollary}

\begin{proof}
\cref{proposition:del}及び\cref{proposition:psc}から従う．
\end{proof}

\begin{definition}
$ F \subset \mathbb{R}[x_1,\dots,x_n] $ を有限部分集合とする．$ S \subset \mathbb{R}^{n-1} $が$ F $描画可能とする．
このとき，$ S $上の$ F $の解を$ f_1(x)< \dots <f_k(x) $とし，$ f_0(x) := -\infty $ , $ f_{k+1}(x) := \infty $とするとき，
\begin{align*}
  C_{2i} &:= \{(x,y) \mid  x \in S, f_i(x) = y \} \quad i = 1,\dots, k,\\
  C_{2i+1} &:= \{(x,y) \mid x \in S, f_{i}(x)<y<f_{i+1}(x) \} \quad i = 0,1, \dots, k 
\end{align*}

とすれば，$\{C_j\}_{j=1}^{2k+1}$は$ S \times \mathbb{R} $の$F$符号不変な分割を与える．
この$ S \times \mathbb{R} $の分割$ \{C_j\}_{j=1}^{2k+1} $を，$ S $の持ち上げといい，$ \mathfrak{L}(S) $と書く．

また，$\mathfrak{D}$が$\R^{n-1}$の分割であるとき，$\mathfrak{L}(\mathfrak{D}) := \bigcup_{D \in \mathfrak{D}}\mathfrak{L}(D)$を$\mathfrak{D}$の持ち上げという．
\end{definition}

以上より，有限部分集合$F \subset \R[x_1, \dots, x_n]$が与えられたとき，$F$の符号不変な分割を取得するアルゴリズムは次のように表現される．

\begin{algorithm}
    \caption{CADアルゴリズム}
    \begin{algorithmic}[1]
    \REQUIRE $n \geq 1$: 自然数，$F \subset \R[x_1, \dots, x_n]$: 有限部分集合
    \ENSURE $\mathfrak{D}$: $\R^n$の$F$符号不変な分割
    \STATE $\mathfrak{D} \leftarrow \text{$\PROJ^{n-1}(F)$-符号不変な$\R^1$の分割}$
    \STATE $k \leftarrow 1$
    \WHILE{$k < n$}
    \STATE $\mathfrak{D} \leftarrow \text{$\mathfrak{L}(\mathfrak{D})$: $\mathfrak{D}$の持ち上げ}$
    \STATE $k \leftarrow k+1$
    \ENDWHILE
    \end{algorithmic}
\end{algorithm}

このアルゴリズムを実際にコンピュータ上に実装するには，$\R^n$の分割でなく，分割の各セルから代表元を取得したものを得る．

\section{QEとCADアルゴリズム}
有限部分集合$F \subset \R[x_1, \dots, x_n]$が与えられたとき，
前節では$\R^n$の$F$符号不変な分割$\mathfrak{D}$を構成することができることを示した．
実はこのCADアルゴリズムによる分割は半代数的集合となっているのだが，各セルの定義式がどのようになっているかは記述できていない．
量化子消去を行うには実際に各セル$D \in \mathfrak{D}$について，$D$の定義式が必要である．

そのため，まず始めに定義式まで明示できるようにCADアルゴリズムを改良する．

\subsection{増補射影}

\begin{definition}
     次数$m$の実係数多項式$f(x) \in \R[x] \setminus \{0\}$に対し，
     \begin{align*}
          F_0(x) &:= f(x),\\
          F_i(x) &:= \frac{d^i f}{dx^i}(x) \quad i = 1, \dots, m
     \end{align*}
     とする．この多項式の列$\{F_i\}_{i=0}^m$を，$f(x)$のフーリエ列という．
\end{definition}

\begin{theorem}[トムの補題]
     次数$m$の実係数多項式$f(x) \in \R[x] \setminus \{0\}$をとる．
     このとき，各$\sigma \in \{-1, 0, +1\}^{m+1}$に対して，
     \begin{align*}
          \mathfrak{R}_f(\sigma) := \{x \in \R \mid \sign(F_i(x)) = \sigma_i, \, i = 1, \dots, m \}
     \end{align*}
     とすると, $\mathfrak{R}_f(\sigma)$は空集合，一点からなる集合，開区間のいずれかである．
\end{theorem}

\begin{proof}
     後で書く．帰納法で示せる．
\end{proof}


\end{document}