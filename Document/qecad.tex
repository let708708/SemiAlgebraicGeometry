\documentclass[uplatex, dvipdfmx]{jsarticle}

\usepackage{amsmath,amssymb,mathtools}
\usepackage{amsthm}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{cleveref}
\usepackage{todonotes}

\numberwithin{equation}{section}
\makeatletter
\renewenvironment{proof}[1][\proofname]{\par
  \pushQED{\qed}%
  \normalfont \topsep6\p@\@plus6\p@\relax
  \trivlist
  \item\relax
  {\bfseries
  #1\@addpunct{.}}\hspace\labelsep\ignorespaces
}{
  \popQED\endtrivlist\@endpefalse
}
\makeatother

\newcommand{\R}{\mathbb{R}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Ralg}{\mathbb{R}_\mathrm{alg}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Qua}{\mathcal{Q}}
\newcommand{\M}{\mathfrak{M}}
\newcommand{\calL}{\mathcal{L}}
\newcommand{\calS}{\mathcal{S}}
\newcommand{\calP}{\mathcal{P}}
\newcommand{\defiff}{ :\Leftrightarrow}
\newcommand{\RCF}{\mathrm{RCF}}
\newcommand{\Var}{\mathrm{Var}}
\newcommand{\psc}{\mathrm{psc}}
\newcommand{\PSC}{\mathrm{PSC}}
\newcommand{\Elim}{\mathrm{Elim}}
\newcommand{\Tru}{\mathrm{Tru}}
\newcommand{\RED}{\mathrm{RED}}
\newcommand{\LT}{\mathrm{LT}}
\newcommand{\LC}{\mathrm{LC}}
\newcommand{\red}{\mathrm{red}}
\newcommand{\PROJ}{\mathrm{PROJ}}
\newcommand{\APROJ}{\mathrm{APROJ}}     
\newcommand{\Reali}{\mathrm{Reali}}
\newcommand{\der}{\mathrm{der}}
\newcommand{\sign}{\mathrm{sign}}
\newcommand{\SIGN}{\mathrm{SIGN}}
\newcommand{\CSIGN}{\mathrm{CSIGN}}
\newcommand{\map}[3]{{#1}\colon{#2}\rightarrow{#3}}
\newcommand{\norm}[1]{\| {#1} \|}
\newcommand{\true}{\text{true}}
\newcommand{\false}{\text{false}}

\renewcommand{\algorithmicrequire}{\textbf{Input:}}
\renewcommand{\algorithmicensure}{\textbf{Output:}}

\theoremstyle{definition}
\newtheorem{definition}{定義}[section]
\crefname{definition}{定義}{定義}
\newtheorem{proposition}[definition]{命題}
\crefname{proposition}{命題}{命題}
\newtheorem{lemma}[definition]{補題}
\crefname{lemma}{補題}{補題}
\newtheorem{theorem}[definition]{定理}
\crefname{theorem}{定理}{定理}
\newtheorem{corollary}[definition]{系}
\crefname{corollary}{系}{系}
\newtheorem*{claim*}{主張}
\newtheorem{remark}[definition]{注意}
\newtheorem{example}[definition]{例}

\renewcommand{\proofname}{\textbf{証明}}
\renewcommand{\theenumi}{(\arabic{enumi})}
\renewcommand{\labelenumi}{\theenumi}

\begin{document}

\title{実閉体上の柱状代数分解による量化記号消去}
\author{富永 直弥}
\maketitle

% \tableofcontents

\section{実閉体}

まず，\cite{MR3069467}でArtinとSchreierにより導入された，実閉体の概念についてまとめる．
始めに，順序体の定義を述べる．
以下の定義は\cite[Definition 1.1.1.]{MR1659509}に従った．

\begin{definition}[順序体]
     体$F$と$F$上の全順序$<$の組$(F,<)$が次の性質を満たすとき，$(F,<)$を順序体(ordered field)という．
     \begin{enumerate}
          \item 任意の$x,y,z\in F$に対し，$x \leq y$ならば$x + z \leq y + z$である．
          \item 任意の$x,y \in F$に対し，$x \geq 0$, $y \geq 0$ならば$x \cdot y \geq 0$である．
     \end{enumerate}
\end{definition}

以下の定理が成り立つ．

\begin{theorem}[{cf.~\cite[Theorem 1.1.8.]{MR1659509}}]\label{theorem:real-field}
     $F$を体とする．このとき，以下は同値である．
     \begin{enumerate}
          \item \label{theorem:real-field-1}
          $F$が順序体となるような全順序$<$を持つ．
          \item \label{theorem:real-field-2}
          任意の$x_1, \dots, x_n \in F$に対して
          \begin{equation}
               x_1^2 + \dots + x_n^2 \neq -1.
          \end{equation}
          \item \label{theorem:real-field-3}
          任意の$x_1, \dots, x_n \in F$に対して
          \begin{equation}
               \sum_{i=1}^n x_i^2 = 0 \Rightarrow x_1 = \dots = x_n = 0.
          \end{equation}
     \end{enumerate}
\end{theorem}

さらに，\cite[Definition 1.1.9.]{MR1659509}に従い，実体を定義する．

\begin{definition}[実体]
     体$F$が\cref{theorem:real-field}の
     \ref{theorem:real-field-1},
     \ref{theorem:real-field-2},
     \ref{theorem:real-field-3}
     のいずれか（従って、全て）の条件を満たすとき，
     $F$を実体(real field)という．
\end{definition}


例えば，実数体$\R$や有理数体$\Q$，有理数体$\Q$に$\sqrt{2}$を添加した体$\Q\left(\sqrt{2}\right)$は，
通常の全順序構造を入れることにより順序体となる．
したがって，$\R, \Q, \Q\left(\sqrt{2}\right)$はいずれも実体である．

また，複素数体$\C$は$\sqrt{-1}^2 = -1$をみたす元$\sqrt{-1}$を持つ．
したがって，$\C$は実体ではない．

有理数体$\Q$は，実体$\Q\left(\sqrt{2}\right)$を代数拡大に持つが，
実数体$\R$の代数拡大で実体になるものは$\R$自身のみである．
そのような性質に注目し，実閉体の概念を導入する．

\begin{definition}[{\cite[Section I]{MR3069467}}] \label{definition:RCF}
     実体$F$が実閉体(real closed field)であるとは，
     $F$の代数拡大で実体になるものは$F$自身に限ることを指す．
\end{definition}

先ほど述べたように，有理数体$\Q$は実閉体ではないが，実数体$\R$は実閉体である．
また，代数的数全体(すなわち, 有理数体$\Q$の代数的閉包) $\overline{\Q}$と実数体$\R$の共通部分$\Ralg \coloneqq \overline{\Q} \cap \R$は実閉体である．
$\Ralg$の元を実代数的数という．

\begin{theorem}[{\cite[S\"{a}tze 1--3]{MR3069467}}] \label{theorem:real-closed-field}
     体$F$について，以下は同値である．
     \begin{enumerate}
          \item 体$F$は実閉体である．
          \item 次を満たす$F$の順序体の構造$<$がただ一つ存在する．
               \begin{itemize}
                    \item 任意の$x \in F$に対し, $x>0$ならば$x = y^2$を満たす$y \in F$が存在する．
                    \item 奇数次数の$F$係数$1$変数多項式は，$F$において少なくとも$1$つの根を持つ．
               \end{itemize}
          \item $F\left[\sqrt{-1}\right] := F[X]/(X^2 + 1)$は代数的閉体である．
     \end{enumerate}
\end{theorem}

\cref{theorem:real-closed-field}の証明は，
\cite[Theorem 1.2.2.]{MR1659509}を見よ．

以下では，実閉体$R$上の区間を，
\begin{equation}
     [a,b]:=\{x \in R \mid a \leq x \leq b\}, \quad (a,b):=\{x \in R \mid a < x < b\}
\end{equation}
のようにかくことにする．

実閉体$R$を係数とする$1$変数多項式に対して，
実数体$\R$上の連続関数や可微分関数と同様の性質が成り立つ．

\begin{proposition}\label{proposition:intermediate}
     $R$を実閉体とし，$f \in R[X]$とする．
     任意の$a,b \in R$に対し，
     $a < b$かつ
     $f(a)f(b)<0$であれば，ある$x \in (a,b)$が存在して，$f(x)=0$を満たす．
\end{proposition}
\begin{proof}
     $R[\sqrt{-1}]$が代数的閉体であるから，
     $f(X)$の既約因子は，
     \begin{align}
          &X-\alpha, \\
          &(X-\beta)^2 + \gamma^2 = (X-\beta-\gamma\sqrt{-1})(X-\beta+\gamma\sqrt{-1})
     \end{align}
     の形のどちらかである($\alpha, \beta, \gamma \in R$, $\gamma \neq 0$)．

     このとき，$(X-\beta)^2 + \gamma^2$の形の既約因子は，$\gamma \neq 0$としているから，$R$上で常に$0$より大きいことに注意する．
     $f(a)f(b)<0$であることから，$f(X)$のある既約因子$g(X)$について，$g(a)g(b)<0$となる．
     実際，もしすべての$f(X)$の既約因子$g(X)$について，$g(a)g(b) \geq 0$であれば，$f(a)f(b)\geq0$となり仮定に反する．
     ここで，先に述べた注意から，$g(a)g(b)<0$となるような$f(X)$の既約因子$g(X)$は，$g(X) = X - \alpha$とかける．
     $g(a)g(b) < 0$であることから，$a<\alpha<b$であり，このとき$f(\alpha)=0$である．
     したがって，命題が示された．
\end{proof}

\begin{proposition}\label{proposition:Rolle}
     $R$を実閉体とし，$f \in R[X]$とする．
     任意の$a, b \in R$に対し，$a<b$かつ
     $f(a)=f(b)=0$であれば，ある$x \in (a,b)$が存在して，$f'(x)=0$である．
\end{proposition}
\begin{proof}
     $(a,b)$上に$f(X)$の根がない場合について示せば十分である．
     実際，もし$(a,b)$上に$f(X)$の根が存在するとき，それらの根を$a < x_1 < \dots < x_k < b$とすれば，
     $x_1$を改めて$b$とすることで$(a,b)$上に$f(X)$の根がない場合に帰着する．

     $(a,b)$上に$f(X)$の根がないと仮定し，
     \begin{equation}
     f(X) = (X-a)^m(X-b)^ng(X), \, g(a)\neq0,\, g(b)\neq0
     \end{equation}
     とおく．このとき，$(a,b)$上$g(X)$の根がないことから，\cref{proposition:intermediate}より，$g(a)g(b)>0$である．
     \begin{equation}
     g_1(X) \coloneqq m(X-b)g(X)+n(X-a)g(X)+(X-a)(X-b)g'(X)
     \end{equation}
     とおくと，
     \begin{equation}
          f'(X) = (X-a)^{m-1}(X-b)^{n-1}g_1(X)
     \end{equation}
     である．
     このとき，
     \begin{align}
     g_1(a) &= m(a-b)g(a), \\
     g_1(b) &= n(b-a)g(b)
     \end{align}
     であるから，$g_1(a)g_1(b)<0$である．
     よって，\cref{proposition:intermediate}より，ある$x \in (a, b)$が存在し$g_1(x)=0$である．
     この$x \in (a,b)$に対して$f'(x)=0$である．
\end{proof}

\begin{corollary}\label{corollary:mean-value}
     $R$を実閉体とし，$f \in R[X]$とする．
     任意の$a, b \in R$に対して，
     $a<b$であれば，
     ある$c \in (a,b)$が存在して，$f(b)-f(a) = (b-a)f'(c)$を満たす．
\end{corollary}

\begin{proof}
     $F(X) \in R[X]$を，
     \begin{equation}
          F(X) \coloneqq f(X) - \left\{\frac{f(b)-f(a)}{b-a}(X-a) + f(a)\right\}
     \end{equation}
     と定義すると，$F(a)=F(b)=0$であるから，\cref{proposition:Rolle}より，
     ある$c \in (a,b)$が存在して，$F'(c)=0$を満たす．
     この$c$に対して，$f(b)-f(a)=f'(c)(b-a)$が成り立つ．
\end{proof}

\begin{corollary}\label{corollary:monotone}
     $R$を実閉体とし，$f \in R[X]$とする．任意の$a, b \in R$に対して、$a<b$であれば以下が成り立つ．
     \begin{enumerate}
          \item \label{corollary:monotone-1}
          任意の$x \in (a,b)$に対して$f'(x)>0$ならば，$f(X)$は$[a,b]$上狭義単調増加である．
          \item \label{corollary:monotone-2}
          任意の$x \in (a,b)$に対して$f'(x)<0$ならば，$f(X)$は$[a,b]$上狭義単調減少である．
     \end{enumerate}
\end{corollary}
\begin{proof}
     \ref{corollary:monotone-2}は\ref{corollary:monotone-1}と同様に示せるので，\ref{corollary:monotone-1}のみ示す．
     $f(X)$が$[a,b]$上狭義単調増加でないとすると，ある$x \in (a,b)$に対して$f'(x) \leq 0$となることを示す．
     $f(X)$が$[a,b]$上狭義単調増加でないとすると，
     $a \leq x_0 < x_1 \leq b$である$x_0, x_1 \in R$が存在して，$f(x_0) \geq f(x_1)$を満たす．
     このとき，\cref{corollary:mean-value}より，$x_0 < x < x_1$である$x \in (a,b)$が存在して，
     $f(x_1) - f(x_0) = f'(x)(x_1 - x_0)$を満たすが、
     この$x \in (a,b)$に対して$f'(x) \leq 0$となる．
\end{proof}

\section{一階述語論理}

この節では，\cite{MR1924282}に従って一階述語論理についてまとめる．

\begin{definition}[{\cite[Definition 1.1.1
     ]{MR1924282}}]
     以下のデータの組$\mathcal{L}$を言語(Language)という．
     \begin{enumerate}
          \item 関数記号(function symbol)の集合$\mathcal{F}$と，各$f \in \mathcal{F}$に対し正整数$n_f$を対応させる写像．
          \item 関係記号(relation symbol)の集合$\mathcal{R}$と，各$R \in \mathcal{R}$に対し正整数$n_R$を対応させる写像．
          \item 定数記号(constant symbol)の集合$\mathcal{C}$．
     \end{enumerate}
\end{definition}

ここで，$n_f$や$n_R$は，関数記号$f$と関係記号$R$がそれぞれ$n_f$変数，$n_R$変数を取ることを意味する．

次に，言語$\mathcal{L}$が与えられたときの構造について定義する．

\begin{definition}[{\cite[Definition 1.1.2]{MR1924282}}]
     以下のデータの組$\mathcal{M}$を$\mathcal{L}$構造($\mathcal{L}$-structure)という．
     \begin{enumerate}
          \item 空でない集合$M$. 
          \item 各$f \in \mathcal{F}$に対し，関数$\map{f^\mathcal{M}}{M^{n_f}}{M}$を対応させる写像．
          \item 各$R \in \mathcal{R}$に対し，集合$R^\mathcal{M} \subset M^{n_R}$を対応させる写像．
          \item 各$c \in \mathcal{C}$に対し，$c^\mathcal{M} \in M$を対応させる写像．
     \end{enumerate}
\end{definition}

$f^\mathcal{M}$, $R^\mathcal{M}$, $c^\mathcal{M}$を，
それぞれ$f \in \mathcal{F}$, $R \in \mathcal{R}$, $c \in \mathcal{C}$の解釈(interpretation)と呼ぶ，

次に，
言語$\mathcal{L}$の記号のほかに，
変数記号(variable symbol) $v_1, v_2, \dots$, 
等号(equality symbol) $=$,
論理記号(logic symbol) $\lor, \land, \lnot, \exists, \forall$
および括弧$($, $)$を用いて，項と論理式を定義する．

\begin{definition}[{\cite[Definition 1.1.4]{MR1924282}}]
     $\mathcal{L}$項($\mathcal{L}$-term)の集合とは，次を満たす最小の集合$\mathcal{T}$である．
     \begin{enumerate}
          \item 定数記号$c \in \mathcal{C}$に対し，$c \in \mathcal{T}$である．
          \item 変数記号$v_i$, $i=1, 2, \dots$, に対し，$v_i \in \mathcal{T}$である．
          \item 関数記号$f \in \mathcal{F}$および$t_1, \dots, t_{n_f} \in \mathcal{T}$に対し，$f(t_1, \dots, t_{n_f}) \in \mathcal{T}$である．
     \end{enumerate}
\end{definition}

$\mathcal{M}$を$\mathcal{L}$構造とする．$\mathcal{L}$項$t$が含む変数記号が高々$v_{i_1}, \dots, v_{i_m}$であるとする．
このとき，$t$を写像$\map{t^\mathcal{M}}{M^m}{M}$として解釈したい．
そこで，$\bar{a} = (a_{i_1}, \dots, a_{i_m}) \in M^m$に対し，$t^\mathcal{M}(\bar{a})$を，以下のように帰納的に定義する．

\begin{enumerate}
     \item 定数記号$c \in \mathcal{C}$に対し，$c^\mathcal{M}(\bar{a}) := c^\mathcal{M}$とする．
     \item 変数記号$v_{i_j}$, $j=1, \dots, m$, に対し，$v_{i_j}(\bar{a}) := a_{i_j}$とする．
     \item 
     関数記号$f \in \mathcal{F}$とする．
     さらに$t_1, \dots, t_{n_f}$を，文字列に含む変数記号が高々$v_{i_1}, \dots, v_{i_m}$である$\mathcal{L}$項で，
     それぞれ$t_i^\mathcal{M}(\bar{a})$が定義されているとする．
     このとき，$t = f(t_1, \dots, t_{n_f})$に対し，
     \begin{equation}
          t^\mathcal{M}(\bar{a}):= f^\mathcal{M}(t_1^\mathcal{M}(\bar{a}), \dots, t_{n_f}^\mathcal{M}(\bar{a}))
     \end{equation}
     と定義する．
\end{enumerate}

\begin{definition}[{\cite[Definition 1.1.5]{MR1924282}}]
     まず，$\mathcal{L}$原子論理式(atomic $\mathcal{L}$-formula)を，次のいずれかの形をした記号列として定義する．
     \begin{enumerate}
          \item $t_1, t_2$を$\mathcal{L}$項として，$(t_1 = t_2)$.
          \item $R \in \mathcal{R}$を述語記号，$t_1, \dots, t_{n_R}$を$\mathcal{L}$項として，$(R(t_1, \dots, t_{n_R}))$.
     \end{enumerate}
     次に，$\mathcal{L}$論理式($\mathcal{L}$-formula)の集合を，以下を満たす最小の集合$\mathcal{W}$として定義する．
     \begin{enumerate}
          \item $\mathcal{W}$は，全ての$\mathcal{L}原子論理式$を含む．
          \item $\phi \in \mathcal{W}$ならば，$\lnot \phi \in \mathcal{W}$である．
          \item $\phi, \psi \in \mathcal{W}$ならば，$(\phi \lor \psi), (\phi \land \psi) \in \mathcal{W}$である．
          \item $\phi \in \mathcal{W}$ならば，任意の変数記号$v_i$に対し$\forall v_i \phi, \exists v_i \phi \in \mathcal{W}$である．
     \end{enumerate}
\end{definition}

$\mathcal{L}$原子論理式およびその否定を，$\mathcal{L}$リテラル($\mathcal{L}$-literal)とよぶ．

ここで，論理式$\phi := \forall x (x^2 + y > 0)$について観察する．ここで，$x,y$はいずれも変数記号である．
これは，「全ての$x$に対して$x^2 + y > 0$が成り立つ」というように読むことができるが，$y$の値は自由に設定することができ，$y$の値が定まらない限りは真であるか偽であるかははっきりしない．
この$y$のように，自由な状態にある変数記号を論理式$\phi$の自由変数という．
厳密には，次のように定義する．以下の定義は，\cite[定義 1.5.1]{C3041}を参考にした．

\begin{definition}
     $\mathcal{L}$を言語とする．
     $\mathcal{L}$項$t$に登場する全ての変数記号を$\Var(t)$で表す．
     $\mathcal{L}$論理式$\phi$の自由変数(free variable)全体$\Var(\phi)$を，次のように帰納的に定義する．
     \begin{enumerate}
          \item $t_1, t_2$を項とするとき，$\Var((t_1=t_2)):=\Var(t_1)\cup\Var(t_2)$と定義する．
          \item $R \in L$を$n$変数述語記号，$t_1, \dots, t_n$を項とするとき，$\Var(R(t_1, \dots, t_n)):= \bigcup_{i=1}^n \Var(t_i)$と定義する．
          \item 論理式$\phi$に対して$\Var(\phi)$が定義されているとき，$\Var(\lnot \phi):=\Var(\phi)$と定義する．
          \item 論理式$\phi, \psi$に対して$\Var(\phi), \Var(\psi)$が定義されているとき，
          $\Var((\phi \lor \psi)):=\Var(\phi)\cup\Var(\psi)$,
          $\Var((\phi \land \psi)):=\Var(\phi)\cup\Var(\psi)$,
          と定義する．
          \item 論理式$\phi$に対して，$\Var(\phi)$が定義されているとき，変数記号$x$に対して
          $\Var(\forall x\phi):=\Var(\phi) \setminus \{x\}$,
          $\Var(\exists x\phi):=\Var(\phi) \setminus \{x\}$
          と定義する．
     \end{enumerate}
     自由変数でない変数を，束縛変数(bound variable)という．
     $\mathcal{L}$論理式$\phi$に登場する自由変数が高々$x_1, \dots, x_n$である事を明示したいとき，$\phi(x_1, \dots, x_n)$と書く．ただし，登場しない自由変数があっても良い．
     $\mathcal{L}$論理式$\phi$が自由変数を持たないとき，すなわち$\Var(\phi)=\emptyset$であるとき，
     $\phi$を$\mathcal{L}$文($\mathcal{L}$-sentense)という．
\end{definition}

\begin{definition}[{\cite[Definition 1.1.6]{MR1924282}}]
     $\mathcal{M}$を$\mathcal{L}$構造とする．
     $\mathcal{L}$論理式$\phi$が$\bar{v} = (v_{i_1}, \dots, v_{i_m})$を自由変数に持つとし，$\bar{a} = (a_{i_1}, \dots, a_{i_m}) \in M^m$とする．
     このとき，帰納的に$\mathcal{M} \models \phi(\bar{a})$を定義する．
     \begin{enumerate}
          \item 
               $\phi$が$(t_1=t_2)$である場合，
               $\mathcal{M} \models \phi(\bar{a})$を$t_1^\mathcal{M}(\bar{a}) = t_2^\mathcal{M}(\bar{a})$により定義する．
          \item 
               $\phi$が$(R(t_1, \dots, t_{n_R}))$である場合，
               $\mathcal{M} \models \phi(\bar{a})$を$(t_1^\mathcal{M}(\bar{a}), \dots, t_{n_R}^\mathcal{M}(\bar{a}))\in R^\mathcal{M}$により定義する．
          \item
               $\phi$が$\lnot \psi$である場合，
               $\mathcal{M} \models \phi(\bar{a})$を，$\mathcal{M} \models \psi(\bar{a})$でないことにより定義する．
          \item
               $\phi$が$(\psi \lor \theta)$である場合，
               $\mathcal{M} \models \phi(\bar{a})$を，
               $\mathcal{M} \models \psi(\bar{a})$または
               $\mathcal{M} \models \theta(\bar{a})$であることにより定義する．
          \item
               $\phi$が$(\psi \land \theta)$である場合，
               $\mathcal{M} \models \phi(\bar{a})$を，
               $\mathcal{M} \models \psi(\bar{a})$かつ
               $\mathcal{M} \models \theta(\bar{a})$であることにより定義する．
          \item
               $\phi$が$\exists v_j\psi(\bar{v}, v_j)$である場合，
               $\mathcal{M} \models \phi(\bar{a})$を，
               ある$b \in \mathcal{M}$が存在して
               $\mathcal{M} \models \psi(\bar{a},b)$であることにより定義する．
          \item
          $\phi$が$\forall v_j\psi(\bar{v}, v_j)$である場合，
          $\mathcal{M} \models \phi(\bar{a})$を，
          全ての$b \in \mathcal{M}$に対して
          $\mathcal{M} \models \psi(\bar{a},b)$であることにより定義する．
     \end{enumerate}
     $\mathcal{M} \models \phi(\bar{a})$であるとき，$\mathcal{L}$構造$\mathcal{M}$は$\phi(\bar{a})$を満たすという．
\end{definition}

\begin{remark}
     以下の点に注意する．

     \begin{itemize}
          \item
               論理式$\phi, \psi$に対し，
               $\phi \rightarrow \psi$を，$\lnot \phi \lor \psi$の省略とし，
               $\phi \leftrightarrow \psi$を，$(\phi \rightarrow \psi)\land(\psi \rightarrow \phi)$の省略とする．
               また，項$t_1, t_2$に対し，$t_1 \neq t_2$を，$\lnot(t_1 = t_2)$の省略とする．
          \item
               有限個の論理式$\phi_1, \dots, \phi_n$に対して，$\bigvee_{i=1}^n \phi_i$を$(\phi_1 \lor (\phi_2 \lor (\dots \lor \phi_n)))$の省略とする．
               また，$\bigwedge_{i=1}^n \phi_i$を$(\phi_1 \land (\phi_2 \land (\dots \land \phi_n)))$の省略とする．
          \item     
               変数記号は，$v_1, v_2, \dots, $に加え，他の記号$a, b, c, \dots, x, y, z, x_1, x_2, \dots$等も用いることにする．
          \end{itemize}
\end{remark}


\begin{definition}[{\cite[Section 1.2]{MR1924282}}]
     $\mathcal{L}$を言語とする．
     $\mathcal{L}$文からなる集合$T$を，$\mathcal{L}$理論($\mathcal{L}$-theory)という．
     さらに，$\mathcal{L}$構造$\mathcal{M}$が，任意の$\phi \in T$に対し
     $\mathcal{M} \models \phi$を満たすとき，$\mathcal{L}$構造$\mathcal{M}$を$\mathcal{L}$理論$T$のモデル(model)と言い，
     $\mathcal{M} \models T$とかく．
\end{definition}

ここで，実閉体の理論$\RCF$を，\cite[Section 5.2.1]{C3041}に従って定義する．

\begin{example}[実閉体の理論]
     言語$\mathcal{L}_\mathrm{OR}$を，以下のデータの組として\todo{助詞の検討}定義する．
     \begin{itemize}
          \item 定数記号 $0$, $1$.
          \item 1変数関数記号 $-$.
          \item 2変数関数記号 $+$, $\cdot$.
          \item 2変数関係記号 $<$.
     \end{itemize}
     このとき，言語$\mathcal{L}_\mathrm{OR}$上の実閉体の理論$\RCF$を，次の$\mathcal{L}_\mathrm{OR}$文全体の集合として\todo{助詞の検討}定義する．

          \begin{enumerate}
               \item $\forall x \forall y \forall z(x + (y + z) = (x + y) + z)$,
               \item $\forall x (x + 0 = x)$,
               \item $\forall x ((x + (-x) = 0)\land((-x) + x = 0))$,
               \item $\forall x \forall y (x + y = y + x)$,
               \item $\forall x \forall y (x \cdot y = y \cdot x)$,
               \item $\forall x \forall y \forall z((x \cdot y) \cdot z = x \cdot (y \cdot z))$,
               \item $\forall x \forall y \forall z(x \cdot (y + z) = x \cdot y + x \cdot z)$,
               \item $\forall x (x \cdot 1 = x)$,
               \item $0 \neq 1$,
               \item $\forall x \exists y (x \neq 0 \rightarrow x \cdot y = 1)$,
               \item $\forall x \lnot (x < x)$,
               \item $\forall x \forall y \forall z(x < y \land y < z \rightarrow x < z)$,
               \item $\forall x \forall y (x < y \lor x = y \lor y < x)$,
               \item $\forall x \forall y \forall z(x < y \rightarrow x + z < y + z)$,
               \item $\forall x \forall y (0 < x \land 0 < y \rightarrow 0 < x \cdot y)$,
               \item $\forall x \exists y (x = y^2 \lor -x = y^2)$
               \item $\forall x_{2n} \dots \forall x_1 \forall x_0 \exists y (y^{2n+1} + x_{2n} \cdot y^{2n} + \cdots + x_1 \cdot y + x_0 = 0)$ ( $n =  1, 2 , \dots$ ).
          \end{enumerate}

     ここで，項$t$に対し，$t^p$は$t$の$p$個の積$(t\cdot(t\cdot(\dots \cdot t)))$の省略とする．
\end{example}

\begin{remark}以下の点に注意する．
     \begin{itemize}
          \item 
          定数記号$1$の$p$個の和$(1+(1 + (\dots + 1)))$の省略として$p$を用いる．
          \item 
          $t \leq t'$を，$(t<t') \lor (t=t')$の省略とする．
          \item
          $t > t'$, $t \geq t'$を，それぞれ$t' < t$, $t' \leq t$の省略とする．
     \end{itemize}
\end{remark}


順序環の言語$\mathcal{L}_{\mathrm{OR}}$において，$\mathcal{L}_\mathrm{OR}$構造$\R=(\R,0,1,-,+,\cdot,<)$や$\Ralg=(\Ralg,0,1,-,+,\cdot,<)$は，
\begin{equation}
     \R \models \RCF, \quad \Ralg \models \RCF
\end{equation}
であり，構造$\R$,$\Ralg$はいずれも実閉体の理論$\RCF$のモデルである．

\begin{definition}[{\cite[Definition 1.2.12]{MR1924282}}]
     $T$を$\mathcal{L}$理論とし，$\phi$を$\mathcal{L}$文とする．
     $\phi$が$T$の論理的帰結(logical consequence)であるとは，任意の$T$のモデル$\mathcal{M}$に対し，
     $\mathcal{M} \models \phi$であることと定義する．
     $\phi$が$T$の論理的帰結であるとき，$T \models \phi$とかく．

     特に，$T = \emptyset$の場合，全ての$\mathcal{L}$構造は$T$のモデルである．$\phi$が$T=\emptyset$の論理的帰結であることを，
     $\models \phi$と表す．
\end{definition}

$\mathcal{L}$論理式$\phi$に現れる自由変数が高々$v_1, \dots, v_n$であるとする．
$T \models \forall v_1 \dots \forall v_n \phi(v_1, \dots, v_n)$が成り立つとき，
同様に$\mathcal{L}$論理式$\phi$は$\mathcal{L}$理論$T$の論理的帰結であるといい，$T \models \phi$と表す．

最後に，以下の3つの命題を示す．

\begin{proposition}\label{proposition:nnt}
     任意の$\mathcal{L}$論理式$\phi$に対し，
     $\mathcal{L}$リテラルから論理記号$\forall$, $\exists$, $\lor$, $\land$のみによって生成される$\mathcal{L}$論理式$\psi$が存在し，
     \begin{equation}
          \models \phi \leftrightarrow \psi
     \end{equation}
     である．このような$\mathcal{L}$論理式$\psi$を否定標準形(negation normal form)の論理式という．
\end{proposition}
\begin{proof}
     De Morganの法則\todo{言うらしい}
     \begin{align}
          &\models \lnot (\theta_1 \lor \theta_2) \leftrightarrow (\lnot \theta_1 \land \lnot \theta_2)\\
          &\models \lnot (\theta_1 \land \theta_2) \leftrightarrow (\lnot \theta_1 \lor \lnot \theta_2)\\
          &\models \lnot \forall x \theta \leftrightarrow \exists x \lnot \theta\\
          &\models \lnot \exists x \theta \leftrightarrow \forall x \lnot \theta
     \end{align}
     と，二重否定の除去
     \begin{equation}
          \models \lnot \lnot \theta \leftrightarrow \theta
     \end{equation}
     を用いて，否定記号$\lnot$を括弧の内側に入れていくことで示される．
\end{proof}

\begin{proposition}\label{proposition:dnf}
     任意の量化記号のない$\mathcal{L}$論理式$\phi$に対して，有限個の$\mathcal{L}$リテラル$L_{i,j}$が存在して
     \begin{equation}
          \models \phi \leftrightarrow \bigvee_{i=1}^n \bigwedge_{j=1}^{m_i} L_{i,j}
     \end{equation}
     を満たす．$\bigvee_{i=1}^n \bigwedge_{j=1}^{m_i} L_{i,j}$の形をした論理式を，和積標準形(disjunctive normal form)の論理式という．
\end{proposition}

\begin{proof}

     \cref{proposition:dnf}より，$\mathcal{L}$論理式$\phi$が否定標準形の論理式の場合に命題が成り立つことを示せばよい．
     この場合，$\phi$は量化記号のない論理式であるから，$\phi$に含まれる論理記号は$\lor$, $\land$のみであることに注意する．
     
     $\phi$に含まれる論理記号の数に関する帰納法で証明する．

     まず，$\phi$が原子論理式の場合は明らかである．

     次に，論理記号の数が$k$個以下である場合に命題が成り立つと仮定して，論理記号の数が$k+1$個の論理式$\phi$の場合にも命題が成り立つことを示す．
     このとき，$\phi = \psi \lor \psi'$または$\phi = \psi \land \psi'$とかける，
     帰納法の仮定より，
     \begin{align}
          &\models \psi \leftrightarrow \bigvee_{i} \bigwedge_j L_{i,j},\\
          &\models \psi' \leftrightarrow \bigvee_{i'} \bigwedge_{j'} L'_{i',j'}
     \end{align}
     であるように有限個のリテラル$L_{i,j}$および$L'_{i,j}$を取ることができる．
     このとき，
     \begin{align}
          &\models \psi \lor  \psi' \leftrightarrow \left( \bigvee_i \bigwedge_j L_{i,j} \right) \vee \left( \bigvee_{i'} \bigwedge_{j'} L'_{i',j'}\right)\\
          &\models \psi \land \psi' \leftrightarrow \bigvee_{i, i'} \left(\bigwedge_j L_{i,j} \wedge \bigwedge_{j'} L'_{i',j'}\right)
     \end{align}
     であるから，論理式$\phi$についても命題が成り立つ．
     したがって，帰納法により命題が示された．
\end{proof}

\begin{proposition}\label{proposition:pnf}
     任意の$\mathcal{L}$論理式$\phi$に対し，ある量化記号のない$\mathcal{L}$論理式$\psi$及び量化記号$\Qua_1, \dots, \Qua_m \in \{\forall, \exists\}$が存在して，
     \begin{equation}
          \models \phi \leftrightarrow \Qua_1 v_1 \dots \Qua_m v_m \psi
     \end{equation}
     を満たす．$\Qua_1 v_1 \dots \Qua_m v_m \psi$の形をした論理式を冠頭標準形(prenex normal form)の論理式という．
\end{proposition}
\begin{proof}
     \cref{proposition:dnf}より，$\mathcal{L}$論理式$\phi$が否定標準形の論理式の場合に命題が成り立つことを示せばよい．
     
     $\phi$に含まれる論理記号の数に関する帰納法で証明する．
     
     まず，$\phi$が原子論理式の場合は明らかである．
     次に，論理記号の数が$k$個以下である場合に命題が成り立つと仮定して，論理記号の数が$k+1$個の論理式$\phi$の場合にも命題が成り立つことを示す．
     \begin{itemize}
          \item
               $\phi = \forall x \psi$または$\phi = \exists x \psi$の場合，
               帰納法の仮定より，ある量化記号のない論理式$\theta$および量化記号$\Qua_1, \dots, \Qua_m \in \{\forall, \exists\}$を用いて
               \begin{equation}
                    \models \psi \leftrightarrow \Qua_1 v_1, \dots, \Qua_m v_m \theta
               \end{equation}
               が成り立つ．よって，
               \begin{align}
                    &\models \forall x \psi  \leftrightarrow \forall x \Qua_1 v_1, \dots, \Qua_m v_m \theta\\
                    &\models \exists x \psi  \leftrightarrow \exists x \Qua_1 v_1, \dots, \Qua_m v_m \theta
               \end{align}
               より，論理式$\phi$についても命題が成り立つ．
          \item
               $\phi = \psi \land \psi'$または$\phi = \psi \lor \psi'$の場合，
               帰納法の仮定より，ある量化記号のない論理式$\theta, \theta'$および量化記号$\Qua_1, \dots, \Qua_m, \Qua'_1, \dots, \Qua'_{m'} \in \{\forall, \exists\}$を用いて
               \begin{align}
                    &\models \psi \leftrightarrow \Qua_1 v_1, \dots, \Qua_m v_m \theta\\
                    &\models \psi' \leftrightarrow \Qua'_1 w_1, \dots, \Qua'_{m'} w_{m'} \theta'
               \end{align}
               とできる．必要ならば変数記号を置き換えて，$\psi'$の自由変数に$v_1, \dots, v_m$が現れず，$\psi$の自由変数に$w_1, \dots, w_{m'}$が現れないとしてよい．
               このとき，
               \begin{align}
                    &\models \psi \land \psi' \leftrightarrow \Qua_1 v_1, \dots, \Qua_m v_m \Qua'_1 w_1, \dots, \Qua'_{m'} w_{m'}(\theta \land \theta')\\
                    &\models \psi \lor \psi' \leftrightarrow \Qua_1 v_1, \dots, \Qua_m v_m \Qua'_1 w_1, \dots, \Qua'_{m'} w_{m'}(\theta \lor \theta')
               \end{align}
               より，論理式$\phi$についても命題が成り立つ．
     \end{itemize}
     したがって，帰納法により命題が示された．
\end{proof}


\section{量化記号消去}

\begin{example}
     言語$\mathcal{L}_\mathrm{OR}$上の次のような論理式を考える．
     \begin{equation}
          \phi(a) := \forall x (x^2 + ax + a + 3 > 0)
     \end{equation}

     簡単のため，実閉体のモデルである実数体$\R$をとって考える．すなわち，上記の論理式は次のように言い換えられる．
     \begin{equation}
          \text{全ての実数$x \in \R$に対して$x^2 + ax + a + 3 > 0$をみたす．}  
     \end{equation}
     これを，変数記号$a$についての条件と解釈すると，2次方程式$x^2 + ax + a + 3 = 0$の判別式が0より大きいことに必要十分であるから，
     \begin{equation}
          \psi(a) := (a < -2) \lor (6 < a)
     \end{equation}
     に同値である．すなわち，次が成り立つ．
     \begin{equation}
          \R \models \forall a (\phi(a) \leftrightarrow \psi(a)).
     \end{equation}
\end{example}

上記の例は，実数体$\R$についてのみ考察しているが，実は，全ての$\RCF$のモデル$R$に対して
\begin{equation}
     R \models \forall a (\phi(a) \leftrightarrow \psi(a))
\end{equation}
が成り立つ．ここで，$\phi$には束縛変数$x$が現れており，一方で$\psi$に登場する変数記号は全て自由変数である．
つまり，$\phi$に登場する量化記号を消去し，自由変数のみの論理式$\psi$で記述できている．このような現象を扱うために，「量化記号を消去する」概念を定義する．


\begin{definition}[{\cite[Definition 3.1.1.]{MR1924282}}]
理論$T$で量化記号消去(quantifier elimination)を持つとは，
$L$上の任意の論理式$\phi$に対し，量化記号のない論理式$\psi$が存在し，
\begin{equation}
     T \models \phi \leftrightarrow \psi
\end{equation}
が成り立つことと定義する．
\end{definition}

\begin{theorem}[{\cite[Theorem 11]{MR0044472}}]\label{theorem:Tarski}
     言語$\mathcal{L}_\mathrm{OR}$上の実閉体の理論$\RCF$は量化記号消去を持つ．
\end{theorem}

以降この節は\cref{theorem:Tarski}の証明を述べる．

この定理の証明および後々の議論のため，言語$\mathcal{L}_\mathrm{OR} = \{0, 1,-, +, \cdot, < \}$上の原子論理式について注意をする．

$X_1, \dots, X_n$を変数記号とする．多項式$f \in \Z[X_1, \dots, X_n]$が与えられるとき，$f(X_1, \dots, X_n)$は$\mathcal{L}$項として自然に解釈できる．

このとき，以下のように原子論理式の省略記号を導入する．
\begin{align}
     \sign (f(X_1, \dots, X_n)) = 1 & \defiff f(X_1, \dots, X_n) > 0\\
     \sign (f(X_1, \dots, X_n)) = 0 & \defiff f(X_1, \dots, X_n) = 0\\
     \sign (f(X_1, \dots, X_n)) = -1 & \defiff f(X_1, \dots, X_n) < 0
\end{align}

このとき，$\RCF$において，任意の原子論理式$\phi(X_1, \dots, X_n)$は，ある多項式$f \in \Z[X_1, \dots, X_n]$及び$\sigma \in \{-1, 0, 1\}$に対して，
$\sign(f(X_1, \dots, X_n)) = \sigma$と同値であることに注意する．

また，$\lnot(\sign(f(X_1, \dots, X_n)) = \sigma)$は，
$\bigvee_{\tau \in \{-1,0,1\} \setminus \{\sigma\}} (\sign(f(X_1, \dots, X_n)) = \tau)$と同値であることにも注意する．

それでは，\cref{theorem:Tarski}を示していく．そのために，まずは次の補題を準備する．

\begin{lemma}\label{lemma:qe_simplify}
     $\overline{Y} = (Y_1, \dots, Y_n)$とする．
     言語$\mathcal{L}_\mathrm{OR}$上の理論$\RCF$において，以下は同値である．
     \begin{enumerate}
          \item \label{lemma:qe_simplify_1}
          理論$\RCF$は量化記号消去を持つ．
          \item \label{lemma:qe_simplify_2}
          任意の$f_1, \dots, f_s \in \Z \left[X, \overline{Y}\right]$および$\map{\sigma}{\{1, \dots, s\}}{\{-1,0,1\}}$に対して，
          量化記号のない論理式$\theta\left(\overline{Y}\right)$が存在し，
          \begin{equation}
               \RCF \models \theta\left(\overline{Y}\right) \leftrightarrow \exists X \left(\bigwedge_{i=1}^s \left(\sign\left(f_i\left(X,\overline{Y}\right)\right) = \sigma(i)\right)\right)
          \end{equation}
          \item \label{lemma:qe_simplify_3}
          任意の量化記号のない論理式$\phi\left(X, \overline{Y}\right)$に対し，
          ある量化記号のない論理式$\theta\left(\overline{Y}\right)$が存在し，
          \begin{equation}
               \RCF \models \theta\left(\overline{Y}\right) \leftrightarrow \exists X \phi\left(X, \overline{Y}\right)
          \end{equation}
     \end{enumerate}
\end{lemma}

\begin{proof}
     \ref{lemma:qe_simplify_1}を満たせば\ref{lemma:qe_simplify_2}を満たすことは明らかである．
     次に，\ref{lemma:qe_simplify_2}を満たせば\ref{lemma:qe_simplify_3}を満たすことを示す．

     任意の量化記号のない論理式$\phi(X, \overline{Y})$について，\cref{proposition:dnf}と同様の証明により，
     多項式$f_{i,j} \in \Z[X, Y_1, \dots, Y_n]$ ($i=1, \dots, k, j=1, \dots, l_i$)
     と$\map{\sigma_i}{\{1, \dots, l_i\}}{\{-1,0,1\}}$を，
     \begin{equation}
          \RCF \models
          \phi\left(X, \overline{Y}\right) \leftrightarrow 
          \bigvee_i \bigwedge_j \left(\sign\left(f_{i,j}\left(X, \overline{Y}\right)\right) = \sigma_i(j)\right)
     \end{equation}
     を満たすように取れる．このとき，
     \begin{equation}
          \RCF \models 
          \exists X \phi\left(X, \overline{Y}\right) \leftrightarrow  
          \bigvee_i \left(\exists X \bigwedge_j \left(\sign\left(f_{i,j}\left(X, \overline{Y}\right)\right) = \sigma_i(j)\right)\right)
     \end{equation}
     が成り立つ．ここで，\ref{lemma:qe_simplify_2}より，各$i=1, \dots, k$に対して，
     \begin{equation}
          \RCF \models
          \theta_i\left(\overline{Y}\right) \leftrightarrow 
          \exists X \bigwedge_j \left(\sign\left(f_{i,j}\left(X, \overline{Y}\right)\right) = \sigma_i(j)\right)
     \end{equation}
     を満たす量化記号のない論理式$\theta_i\left(\overline{Y}\right)$が存在する．このとき，
     \begin{equation}
          \RCF \models
          \bigvee_i \theta_i\left(\overline{Y}\right)\leftrightarrow
          \exists X \phi\left(X, \overline{Y}\right) 
     \end{equation}
     である．したがって，\ref{lemma:qe_simplify_3}を満たす．

     最後に，\ref{lemma:qe_simplify_3}を満たせば，\ref{lemma:qe_simplify_1}を満たすことを示す．
     \cref{proposition:pnf}より，任意の量化記号のない論理式$\phi\left(X_1, \dots, X_m, \overline{Y}\right)$および$\Qua_1, \dots, \Qua_m \in \{\forall, \exists\}$に対し，
     ある量化記号のない論理式$\theta\left(\overline{Y}\right)$が存在し，
     \begin{equation}
          \RCF \models 
          \Qua_1 X_1 \dots\Qua_m X_m \phi\left(X_1, \dots, X_m, \overline{Y}\right) \leftrightarrow \theta\left(\overline{Y}\right)
     \end{equation}
     を満たすことを示せばよい．これは，\ref{lemma:qe_simplify_3}と
     \begin{equation}
          \models \forall X \psi \leftrightarrow \lnot \exists X \lnot \psi
     \end{equation}
     を用いて，$m$に関する帰納法により示される．
     以上より，証明が完了した．
\end{proof}

\cref{lemma:qe_simplify}の\ref{lemma:qe_simplify_2}により，\cref{theorem:Tarski}は，次のように言い換えることができる．

\begin{theorem}[{\cite[Theorem 1.4.2.]{MR1659509}}]\label{theorem:weak_Tarski}
     $\overline{Y} = (Y_1, \dots, Y_n)$と$X$を変数記号とする．任意の$f_1, \dots, f_s \in \Z\left[ \overline{Y},X \right]$および$\map{\sigma}{\{1, \dots, s\}}{\{-1, 0, 1\}}$に対して，
     量化記号のない論理式$\theta\left(\overline{Y}\right)$が存在して，次を満たす．

     任意の実閉体$R$と，任意の$\overline{y} = (y_1, \dots, y_n) \in R^n$に対し，次の2つが同値になる．
     \begin{enumerate}
          \item 実閉体$R$は$\exists X \bigwedge_{i=1}^s (\sign(f_i(X,\overline{y})) = \sigma(i))$ を満たす．
          \item 実閉体$R$は$\theta\left(\overline{y}\right)$を満たす．
     \end{enumerate}
\end{theorem}

よって，\cref{theorem:weak_Tarski}を\cite[Section 1.4]{MR1659509}に従って証明する．

ここで，実閉体$R$において，いくつかの記号を導入する．
まず，$\map{\sign_R}{R}{\{-1,0,1\}}$を次のように定める．
\begin{equation}
     \sign_R(a) :=
     \begin{cases}
          1 & a > 0 \\
          0 & a = 0 \\
          -1 & a < 0
     \end{cases}
\end{equation}

さらに，多項式$f_1, \dots, f_s \in R[X]$に対し，
$\SIGN_R(f_1, \dots, f_s)$を次のように定める．

恒等的に0でないような全ての$f_i$の$R$上の根を$x_1< \dots< x_N$とする．
また，$x_0 := -\infty$, $x_{N+1} := \infty$とし，各$k=0, \dots, N$に対し$I_k := (x_k, x_{k+1})$と書く．
このとき，\cref{proposition:intermediate}より，$x \in I_k$に対し$\sign_R(f(x))$は一定である．これを，$\sign_R(f_i(I_k))$と書く．

第$i=1, \dots s$行が
\begin{equation}
     \sign_R(f_i(I_0)), \sign_R(f_i(x_1)), \sign_R(f_i(I_1)), \dots, \sign(f_i(x_N)), \sign(f_i(I_N))
\end{equation}
であるような$s$行$2N+1$列行列を$\SIGN_R(f_1, \dots, f_s)$と書く．$\SIGN_R(f_1, \dots, f_s)$の各成分は$-1, 0, 1$のいずれかであることに注意する．

$m:= \max\{\deg(f_i) \mid i=1, \dots, s\}$とすれば，$N \leq sm$である．

また，正整数$s, m$に対して，各成分が$-1,0,1$のいずれかである$s$行$(2l+1)$列行列($0 \leq l \leq sm$)全体を$W_{s,m}$と書く． 

\begin{lemma}[{\cite[Lemma 1.4.4.]{MR1659509}}]\label{lemma:qe_1ststep}
     $\map{\sigma}{\{1, \dots, s\}}{\{-1,0,1\}}$とする．部分集合$W(\sigma) \subset W_{s,m}$を，次を満たすように取れる．

     任意の実閉体$R$と，次数が$m$以下であるような任意の$f_1, \dots, f_s \in R[X]$に対し，以下が同値である．
     \begin{enumerate}
          \item $\SIGN_R(f_1, \dots, f_s) \in W(\sigma)$
          \item ある$x \in R$において$\bigwedge_i (\sign_R(f_i(x)) = \sigma(i)$)が成り立つ．
     \end{enumerate}
\end{lemma}

\begin{proof}
     \begin{equation}
          W(\sigma):=\{A \in P_{s,m} \mid \text{行列$A$のある列が$(\sigma(i))_{i=1}^s$である}\}
     \end{equation}
     とすればよい．
\end{proof}

次の補題は，\cref{theorem:weak_Tarski}の証明の中心となる補題である．

\begin{lemma}[{\cite[Lemma 1.4.5.]{MR1659509}}]\label{lemma:qe_lowering}
     ある写像$\map{\varphi}{W_{2s,m}}{W_{s,m}}$が存在し，次をみたす．

     任意の実閉体$R$と，任意の$f_1, \dots, f_s \in R[X]$について，各$f_i$の次数は$m$以下であり，$f_s$は定数でなく，$f_1, \dots, f_{s-1}$は恒等的に$0$でないとする．
     このとき，$g_1, \dots, g_s \in R[X]$を，それぞれ$f_s$を$f_1, \dots, f_{s-1}$, $f_s'$で割った余りとすれば，
     \begin{equation}
          \SIGN_R(f_1, \dots, f_s) = \varphi(\SIGN_R(f_1, \dots, f_{s-1}, f_s', g_1, \dots, g_s))
     \end{equation}
     である．
\end{lemma}

この補題は，多項式$f_1, \dots, f_s \in R[X]$が与えられた際に，
行列$w:=\SIGN_R(f_1, \dots, f_{s-1}, f_s', g_1, \dots, g_s)$に関する情報のみから
$\SIGN_R(f_1, \dots, f_s)$を構成することで示す． 

\begin{proof}
     $x_1 < \dots < x_N$ ($N \leq 2sm$) を，$f_1, \dots, f_{s-1}, f'_s, g_1, \dots, g_s$のうち，恒等的に0でないような多項式の$R$上の根全体とする．
     この部分列$x_{i_1} < \dots < x_{i_M}$を，$f_1, \dots, f_{s-1}, f'_s$の$R$上の根全体とする．
     この列$i_i, \dots, i_M$は，行列$w$の情報にのみ依存する．
     ここで，$i_0:=0$, $i_{M+1}:=N+1$とし，また，$x_0:= -\infty$, $x_{N+1}:= \infty$とする．
     各$k=1, \dots, M$に対し，$f_1, \dots, f_{s-1}, f_s'$のいずれかは$x_{i_k}$において$0$になる．
     従って，$\map{\theta}{\{1,\dots, M\}}{\{1, \dots, s\}}$を，次を満たすようにとれる．
     \begin{itemize}
          \item 各$k=1, \dots, M$に対して，$\theta(k) \in \{1, \dots, s-1\}$ならば$f_{\theta(k)}(x_{i_k})=0$
          \item 各$k=1, \dots, M$に対して，$\theta(k)=s$ならば$f_s'(x_{i_k}) = 0$
     \end{itemize}
     この性質を満たす$\theta$は，行列$w$の情報のみを用いて定義できることに注意する．
     また，この$\theta$に対して，各$k=1, \dots, M$において$f_s(x_{i_k}) = g_{\theta(k)}(x_{i_k})$が成り立つことにも注意する．

     さらに各$k=0, \dots, M$において，$f_s'$は区間$(x_{i_k}, x_{i_{k+1}})$の上で$0$でない一定の符号をもつから，\cref{corollary:monotone}より，
     $f_s$は区間$(x_{i_k}, x_{i_{k+1}})$上に高々一つの根を持つ．
     また，$f_s$が根を持つ必要十分条件は次のように述べられる．
     \begin{itemize}
          \item $M\neq0$の場合，$k=1, \dots, M-1$に対して，$f_s(X)$が区間$(x_{i_k}, x_{i_{k+1}})$上に解を持つことの必要十分条件は
          \begin{equation}
               \sign_R(g_\theta(k)(x_{i_k}))\sign_R(g_\theta(k+1)(x_{i_{k+1}})) = -1.
          \end{equation}
          \item $M\neq0$の場合，$(-\infty, x_1)$に解を持つことの必要条件は，
          \begin{equation}
               \sign_R(f_s'((-\infty, x_1))) \sign_R(g_\theta(1)(x_1)) = 1.
          \end{equation}
          \item $M\neq0$の場合，$(x_M, \infty)$に解を持つことの必要条件は，
          \begin{equation}
               \sign_R(f_s'((x_M, \infty))) \sign_R(g_\theta(M)(x_M)) = -1.
          \end{equation}
          \item $M = 0$の場合は，$(\infty, \infty)$上に必ず解を持つ．
     \end{itemize}
     いずれの条件も，行列$w$の情報のみで記述されることに注意する．

     さて，ここで$y_1 < \dots < y_L$ ($L \leq sm$) を
     $f_1, \dots, f_{s-1}, f_s$の$R$上の根全体とし，$y_0 = -\infty$, $y_{L+1} = \infty$とする．
     $\map{\rho}{\{0, \dots, L+1\}}{\{0, \dots, M+1\} \cup \{(k,k+1) \mid k=0, \dots, M\}}$を，
     \begin{equation}
          \rho(l) := \begin{cases} 
               k & y_l = x_{i_k},\\
               (k, k+1) & y_l \in (x_{i_k}, x_{i_{k+1}})
          \end{cases}
     \end{equation}
     と定める．上記で述べたことより，$\rho$の定義は，行列$w$の情報にのみ依存する．

     それでは，$\SIGN_R(f_1, \dots, f_s)$が$w$の情報のみに依存して定まる事を示す．
     
     まず，$j=1, \dots, s-1$に対しては，
     \begin{equation}
          \sign_R(f_j(y_l)) = \begin{cases}
               \sign_R(f_j(x_{i_k})) & \rho(l) = k,\\
               \sign_R(f_j((x_{i_k}, x_{i_{k+1}}))) & \rho(l) = (k, k+1)
          \end{cases}
     \end{equation}
     であり，また，
     \begin{equation}
          \sign_R(f_j((y_l,y_{l+1}))) = \sign_R(f_j((x_{i_k}, x_{i_{k+1}}))) \quad \text{$\rho(l)=k$または$\rho(l)=(k,k+1)$}
     \end{equation}
     である．さらに，$j=s$に対しては，
     \begin{equation}
          \sign_R(f_s(y_l)) = \begin{cases}
               \sign_R(g_{\theta(k)}(x_{i_k})) & \rho(l) = k,\\
               0 & \rho(l) = (k, k+1)
          \end{cases}
     \end{equation}
     であり，また，
     \begin{equation}
          \sign_R(f_s((y_l,y_{l+1}))) = \begin{cases}
               \sign_R(g_{\theta(k)}(x_{i_k})) & \rho(l) = k, l \neq 0, g_{\theta(k)}(x_{i_k})\neq 0\\
               \sign_R(f_s'((x_{i_k},x_{i_{k+1}}))) & \rho(l)=k, l \neq 0, g_{\theta(k)}(x_{i_k}) = 0 \\
               \sign_R(f_s'((x_{i_k}, x_{i_{k+1}}))) & \rho(l) = (k, k+1), l \neq 0\\
               -\sign_R(f_s'((-\infty, x_1))) & l=0
          \end{cases}
     \end{equation}
     である．

     以上により$\SIGN_R(f_1, \dots, f_s)$は$w$の情報のみに依存して定まる．よって，証明が完了した．
\end{proof}

以上の準備をもとに，\cref{theorem:weak_Tarski}を示す．
\cref{lemma:qe_1ststep}により，\cref{theorem:weak_Tarski}の証明は，次の命題から従う．

\begin{proposition}[{\cite[Proposition 1.4.6.]{MR1659509}}] \label{proposition:weak_Tarski}
     $\overline{Y}:= (Y_1, \dots, Y_n)$とし，
     $f_1, \dots, f_s \in \Z\left[X, \overline{Y}\right]$をそれぞれ
     $f_i \left(X, \overline{Y} \right) = h_{i, m_i}\left( \overline{Y} \right) X^{m_i} + \dots + h_{i, 0}\left(\overline{Y}\right)$ ($i=1, \dots, s$)とする．
     また，$m:= \max\{m_i \mid i=1, \dots, m\}$とする．
     任意の$W \subset W_{s,m}$に対し，
     ある量化記号のない論理式$\theta\left(\overline{Y}\right)$が存在して次を満たす．

     任意の実閉体$R$と，任意の$\overline{y} := (y_1, \dots, y_n) \in R^n$に対し，以下の2つが同値である．
     \begin{enumerate}
          \item $\SIGN_R(f_1(X, \overline{y}), \dots, f_s(X, \overline{y})) \in W$である．
          \item 実閉体$R$は$\theta(\overline{y})$を満たす．
     \end{enumerate}
\end{proposition}

実際，\cref{proposition:weak_Tarski}において$W=W(\sigma)$とすれば，\cref{theorem:weak_Tarski}が従う．

\begin{proof}[\cref{proposition:weak_Tarski}の証明]
     一般性を失わずに，各多項式$f_i$は恒等的に$0$でなく，$h_{i, m_i} \neq 0$としてよい．
     ここで，多項式の列$(f_1, \dots, f_s)$に対して，各多項式の$X$についての次数の列$(m_1, \dots, m_s)$を対応づける．
     非負整数列全体$\{(m_1, \dots, m_s) \mid s \geq 1, m_1, \dots, m_s\}$上の前順序関係
     \begin{equation}
          (m_1, \dots, m_s) \prec (m_1', \dots, m_{s'}')
     \end{equation}
     を，ある非負整数$p$が存在し，以下の2条件を満たすことと定義する．
     \begin{itemize}
          \item $p$に等しい$m_i$ ($i=1, \dots, s$)の数が，$p$に等しい$m'_i$ ($i=1, \dots, s'$)の数より少ない．
          \item 任意の$q>p$に対して，$q$に等しい$m_i$ ($i=1, \dots, s$)の数が，$q$に等しい$m'_i$ ($i=1, \dots, s'$)の数より少ない．
     \end{itemize}
     この前順序関係$\prec$は，非負整数列全体の中に無限降鎖列は存在しない．
     すなわち，非負整数列の列$\{\mu_i\}_{i \geq 1}$で，$\mu_1 \succ \mu_2 \succ \dots$となるものは存在しない．
     この前順序関係$\prec$に関する帰納法を用いて，命題を証明をする．

     $m:= \max\{m_1, \dots, m_s\}$とする．$m=0$の場合，すなわち$f_1, \dots, f_s \in \Z\left[\overline{Y}\right]$の場合，
     $W':=\{(a_i)_{i=1}^s \in W \mid \text{$(a_i)_{i=1}^s$は$s$行$1$列の行列}\}$として
     \begin{equation}
          \theta\left(\overline{Y}\right) := \bigvee_{(a_i)_{i=1}^s \in W'}\bigwedge_{i=1}^s \left(\sign\left(f_i\left(\overline{Y}\right)\right)=a_i\right)
     \end{equation}
     とすれば，命題を満たす．

     次に，$m \geq 1$の場合を考える．
     この場合は，次数を下げていき，最終的に$f_1, \dots, f_s \in \Z\left[\overline{Y}\right]$の場合に帰着させることで示される．

     まず，多項式の順番を並び替えて，$m_s=m$であるとしてよい．
     \cref{lemma:qe_lowering}で示した$\map{\varphi}{W_{2s,m}}{W_{s,m}}$を取り，
     $W'':= \varphi^{-1}(W)$とする．
     \cref{lemma:qe_lowering}より，任意の実閉体$R$と，任意の$\overline{y} = (y_1, \dots, y_s) \in R^n$に対し，
     各$i=1, \dots, s$に対して$h_{i, m_i}(\overline{y}) \neq 0$であれば以下の2条件は同値である．
     \begin{itemize}
          \item $\SIGN_R(f_1(X,\overline{y}), \dots, f_s(X, \overline{y})) \in W$,
          \item $\SIGN_R(f_1(X,\overline{y}), \dots, f_{s-1}(X, \overline{y}), f_s'(X, \overline{y}), g_1(X,y), \dots, g_s(X,y)) \in W''$,
     \end{itemize}
     ここで，$g_1, \dots, g_{s-1}$は，それぞれ$f_s$を$f_1, \dots, f_{s-1}$により$X$に関して割った余りに，
     $h_{1, m_1}, \dots, h_{s-1, m_{s-1}}$の適切な偶数べき乗を，それぞれの分母が消去できるようにかけて得られる多項式である．
     また，$g_s$は，$f_s$を$f_s'$により$X$に関して割った余りに，$m_s h_{s,m_s}$の適切な偶数べき乗を，分母が消去できるようにかけて得られる多項式である．
     このとき，多項式列$f_1, \dots, f_{s-1}, f_s', g_1, \dots, g_s$の$X$についての次数は，前順序関係$\prec$に関して$(m_1, \dots, m_s)$よりも小さくなる．
 
     一方，ある$i=1, \dots, s$について$h_{i, m_i}(\overline{y}) = 0$である場合，
     そのような$i$については$\widetilde{f}_i := f_i - h_{i, m_i}X^{m_i}$とし，
     それ以外の$i$については$\widetilde{f}_i := f_i$として得られる多項式列$(\widetilde{f}_1, \dots, \widetilde{f}_s)$
     について，以下の2条件は同値である．
     \begin{itemize}
          \item $\SIGN_R(f_1(X,\overline{y}), \dots, f_s(X, \overline{y})) \in W$,
          \item $\SIGN_R(\widetilde{f}_1(X,\overline{y}), \dots, \widetilde{f}_s(X, \overline{y})) \in W$,
     \end{itemize}
     これにより，多項式列$\widetilde{f}_1, \dots, \widetilde{f}_s$の$X$についての次数が，前順序関係$\prec$に関して$(m_1, \dots, m_s)$よりも小さくなる．

     以上により命題の証明が完了した．
\end{proof}

\section{半代数的集合}
以下の定義は，\cite[Definition 2.1.4.]{MR1659509}を参考にした．

\todo[inline]{半代数的集合の定義が導入された論文については不明．}
\begin{definition}
     $R$を実閉体とする．集合$S \subset R^n$が，
     有限個の$f_{i,j} \in R[X_1, \dots, X_n]$および$\sigma_{i,j} \in \{-1, 0 ,1\}$, $i=1, \dots, s, j = 1, \dots, r_i$, をもちいて，
     \begin{equation}
          S = \bigcup_{i=1}^s \bigcap_{j=1}^{r_i} \{x \in R^n \mid \sign_R(f_{i,j}) = \sigma_{i,j}\}
     \end{equation}
     と書けるとき，$S$を$R^n$の半代数的集合という．
\end{definition}

$x \in R^n$, $r \in R$, $r>0$に対して，
\begin{align}
     \norm{x} &:= \sqrt{x_1^2 + \dots + x_n^2},\\
     B_n(x,r) &:= \{y \in R^n \mid \norm{y-x} < r\}
\end{align}
と定義する．

このとき，$\{B_n(x,r)\}$を開基として$R^n$に位相を定義できる．
以降では，$R^n$にはこの位相が入っているものとする．

以下の定理が成り立つ．この定理は，\cite[Theorem 2.2.1]{MR1659509}を参考にした．
\todo[inline]{この定理(Tarski-Seidenberg Principle)の元論文が何か分からない．}
\begin{theorem}\label{theorem:Tarski-Seidenberg}
     $S \subset R^{n+1}$を半代数的部分集合とする．$\map{\pi_{n}}{R^{n+1}}{R^n}$を，
     $\pi_{n}(x_1, \dots, x_n, x_{n+1}) = (x_1, \dots, x_n)$により定める．このとき，
     $\pi_{n}(S)$は$R^n$の半代数的部分集合である．
\end{theorem}

以下の定義は，\cite[Definition 2.2.5.]{MR1659509}を参考にした．
\begin{definition}
     $S \subset R^m$, $T \subset R^n$を，半代数的集合とする．
     写像$\map{f}{S}{T}$が半代数的であるとは，$f$のグラフが$R^{m+n}$の半代数的集合であることと定義する．
\end{definition}

\begin{proposition}
     $\map{f}{A}{B}$を，半代数的写像であるとする．
     もし$S \subset A$が半代数的集合であるならば，$f(S)$も半代数的集合である．
     また，$T \subset B$が半代数的集合であるならば，$f^{-1}(T)$も半代数的集合である．
\end{proposition}

\begin{proof}
     $A \subset R^m$, $B \subset R^n$とし，
     \begin{equation}
          \mathrm{Graph}(f) := \{(x,y) \in R^m \times R^n \mid x \in A, f(x) = y\}
     \end{equation}
     とする．
     $f(S)$は，$(S \times B) \cap \mathrm{Graph}(f)$の射影による像であり，
     $f^{-1}(T)$は，$(A \times T) \cap \mathrm{Graph}(f)$の射影による像であることから，
     \cref{theorem:Tarski-Seidenberg}より示される．
\end{proof}

以下の定義は，\cite[Definition 2.4.2.]{MR1659509}を参考にした．
\begin{definition}
     $S \subset R^n$を半代数的部分集合とする．
     任意の$S$の半代数的閉部分集合$F_1, F_2 \subset S$について，
     $F_1 \cup F_2 = S, F_1 \cap F_2 = \emptyset$ならば，$F_1 = S$または$F_2 = S$を満たすとき，
     $S$を半代数的連結であると定義する．
\end{definition}

この定義より，次の命題が成り立つ．

\begin{proposition}
     $S \subset R^n$を，半代数的連結な半代数的部分集合とする．
     任意の半代数的開部分集合$U_1, U_2 \subset S$について，
     $U_1 \cup U_2 = S$, $U_1 \cap U_2 = \emptyset$ならば，$U_1 = S$または$U_2 = S$である．
\end{proposition}

\begin{proof}
     所与の$U_1, U_2$に対して，各$i=1, 2$に対し$F_i:= S \setminus U_i$とする．
     このとき，各$F_i$は半代数的閉部分集合であり，$F_1 \cup F_2 = S$, $F_1 \cap F_2 = \emptyset$をみたす．
     ここで，半代数的連結の定義より$F_1 = S$または$F_2 = S$である．よって，$U_1 = \emptyset$または$U_2 = \emptyset$である．
     したがって，$U_1 \cup U_2 = S$より，$U_1 = S$または$U_2 = S$となり，命題が示された．
\end{proof}


以下の命題は，\cite[Proposition 3.9.]{MR2248869}を参考にした．
\begin{proposition}
     $S$を半代数的連結な半代数的集合とし，半代数的関数$\map{f}{S}{R}$が局所定数，
     すなわち，任意の$x \in S$に対し，ある$x$の開近傍$U$が存在して，
     任意の$y \in U$に対して$f(y)=f(x)$を満たすとする．
     このとき，$f$は定数関数である．
\end{proposition}
\begin{proof}
     $d \in f(S)$をとる．
     $f$が局所定数関数であることから，$U_1:=f^{-1}(\{d\})$は空でない開集合である．
     さらに，$U_2:=f^{-1}(f(S) \setminus \{d\})$は開集合である．
     さらに，$f$は半代数的関数であることから，$U_1, U_2$はいずれも半代数的集合である．
     $U_1 \cup U_2 = S, U_1 \cap U_2 = \emptyset, U_1 \neq \emptyset$であるから，$S$が半代数的連結であることより，
     $U_1 = S$となる．したがって，$S = f^{-1}(\{d\})$すなわち$f$は定数関数である．
\end{proof}

ここで，$z \in R\left[ \sqrt{-1} \right]$及び$r \in R$, $r>0$, に対し，
\begin{equation}
     D(z, r):= \{w \in R\left[\sqrt{-1}\right] \mid \norm{z - w} < r\}
\end{equation}
とする．ただし，$a,b \in R$に対し$\norm{a + b\sqrt{-1}} := \sqrt{a^2 + b^2}$とする．

以下の定理は，\cite[Theorem 5.12.]{MR2248869}を参考にした．

\begin{theorem} \label{theorem:continuity-of-roots}
     $R$を実閉体とし，$f \in R[X_1, \dots, X_n]$とする．
     また，$S \subset R^{n-1}$を半代数的集合とし，$a \in S$とする．

     $\deg (f(x,X_n))$は$x \in S$に対して一定で，さらに，
     $f(a,X_n)$の相異なる$R\left[\sqrt{-1} \right]$上の根が$z_1, \dots, z_j$で，
     重複度がそれぞれ$\mu_1, \dots, \mu_j$であったとする．

     この時，各$D(z_j, r) \subset R\left[ \sqrt{-1} \right]$ ($i=1, \dots, j$)が
     非交叉であるような任意の$R$の元$r > 0$に対して，
     $a$の開近傍 $V \subset R^{n-1}$を，任意の$x \in V \cap S$に対して，
     $f(x, X_n)$の根が各$D(z_i, r)$ ($i=1, \dots, j$)の中に（重複度込みで）ちょうど$\mu_i$個であるようにとれる．

\end{theorem}

\begin{proof}
    証明は，\cite[Theorem 5.12.]{MR2248869}参照してほしい．
\end{proof}


\section{柱状代数分解}

$R$を実閉体とする．

集合$X$の部分集合族$\calS$が，
\begin{enumerate}
     \item $X = \bigcup_{S \in \calS} S$,
     \item 任意の$S_1, S_2 \in \calS$に対し，$S_1 \neq S_2$ならば$S_1 \cap S_2 = \emptyset$.
\end{enumerate}
を満たすとき，部分集合族$\calS$を$X$の分解(decomposition)と呼ぶ．

まず始めに，$R^n$の柱状代数分解を定義する．この定義は，\cite{MR0764184}\cite[Definition 5.1]{MR2248869}を参考にしているが，
基本的な概念が現れたのは$\cite{MR0403962}$である．

\begin{definition} \label{definition:cad}
     $i=1, \dots, n$に対し，$\calS_i$を$R^i$の分解とする．
     $\{\calS_i\}_{i=1}^n$が$R^n$の柱状代数分解(cylindrical algebraic decomposition)であるとは，
     以下の条件を満たすことをいう．
     \begin{enumerate}
          \item $S \in \calS_1$は，$R$上の点か，開区間かのいずれかである．
          \item $n\geq 2$の場合，任意の$i=1, \dots, n-1$と任意の$S \in \calS_i$に対し，
          有限個の連続な半代数的関数
          \begin{equation}
               \map{\xi_{S,1}< \dots <\xi_{S,l_S}}{S}{R}
          \end{equation}
          が存在し，以下を満たす．（ただし，$l_S$は非負整数とする．）
          \begin{itemize}
               \item 各$j=1 \dots, l_S$に対し，$\xi_{S,j}$のグラフ
               \begin{equation}
                    \{(x,x_{i+1}) \mid x \in S, \xi_{S,j}(x)=x_{i+1} \} \subset R^{i+1}
               \end{equation}
               は，$\calS_{i+1}$の元である．
               \item $\xi_{S,0}=-\infty$, $\xi_{S,l_S+1}=\infty$とするとき，各$j=0, \dots, l_S$に対し，\label{cad_condition1}
               \begin{equation}
                    \{(x,x_{i+1}) \mid x \in S, \xi_{S,j}(x)<x_{i+1}<\xi_{S,j+1} \} \subset R^{i+1}
               \end{equation}
               は，$\calS_{i+1}$の元である．
          \end{itemize}
     \end{enumerate}
\end{definition}

定義より，任意の$k=1, \dots, n$に対して，$\{\calS_i\}_{i=1}^k$は$R^k$の柱状代数分解である．
逆に，$R^{n-1}$の柱状代数分解$\{\calS_i\}_{i=1}^{n-1}$が与えられているとき，各$S \in \calS_{n-1}$に対して
\cref{definition:cad}の条件\ref{cad_condition1}を満たすような有限個の連続半代数関数$\xi_{S,1}<\dots<\xi_{S,l_S}$が与えられれば，
$R^n$の柱状代数分解$\{\calS_i\}_{i=1}^n$を構成することができる．

このように，柱状代数分解は再帰的な構造である．

以下の定義は，\cite[Definition 5.5]{MR2248869}を参照した．
\begin{definition}
     $F \subset R[X_1, \dots, x_n]$を有限部分集合とする．
     \begin{enumerate}
          \item 部分集合$S \subset \R^n$が$F$符号不変($F$-invariant)であるとは，
          任意の$f \in F$及び任意の$x,y \in S$に対し$\sign(f(x))=\sign(f(y))$であることと定義する．

          \item $R^n$の柱状代数分解$\{\calS_i\}_{i=1}^n$が$F$に適合している(adapted to $F$)とは，
          任意の$C \in \calS_n$が$F$符号不変であることと定義する．
     \end{enumerate}
\end{definition}

この節の目的は，次の定理を示すことである．以下の定理は\cite[Theorem 5.6]{MR2248869}を参照した．
基本的なが概念が現れたのは，\cite{MR0403962}である．
\begin{theorem} \label{theorem:cad}
     任意の有限部分集合$F \subset R[X_1, \dots, X_n]$に対して，
     $F$に適合した$R^n$の柱状代数分解が存在する．
\end{theorem}

この定理は，柱状代数分解を次元について帰納的に構成することで証明される．
まず初めに$R^1$の柱状代数分解を与え，
それを基に順に$R^2, R^3, \dots, R^n$の柱状代数分解を構成していく．

\subsection{描画可能}
$F$に適合した$R^n$の柱状代数分解$\{\calS_i\}_{i=1}^n$を$R^{n-1}$の柱状代数分解$\{\calS_i\}_{i=1}^{n-1}$から構成するとき，
各$S \in \calS_{n-1}$は次に定義する性質を満たしてほしい．

なお，次の定義はCollins\cite{MR0403962}によって導入されたものである．
\footnote{
     Collins\cite{MR0403962}による描画可能性の定義は，$R=\R$, $F$が$1$元集合になる場合のみの定義であったが，
     ここでは一般の有限集合の場合に拡張している．
}

\begin{definition} 
     $F \subset R[X_1, \dots, X_n]$を有限部分集合とし，$S \subset R^{n-1}$を半代数的連結な半代数的集合とする．
     $S$が$F$描画可能($F$-delineable)であるとは，$k$個の連続な半代数的関数$\map{\xi_1<\dots<\xi_k}{S}{R}$が存在し，次を満たすことと定義する．
     \begin{itemize}
          \item 任意の$ x \in S $に対し，
          \begin{equation}
               \{\xi_i(x)\}_{i=1}^k = \{y \in R \mid \prod_{f \in F'}f(x,y)=0\}
          \end{equation}
          である．ただし，$F' = \{f \in F \mid \text{$f$は$S$上恒等的に$0$でない}\}$とする．
          \item 各$i=1, \dots, k$および$f \in F'$に対し，多項式$f(x,X_n)$における根$\xi_i(x)$の重複度は，$x\in S$によらず一定．
     \end{itemize}
\end{definition}

$R^{n-1}$の柱状代数分解$\{\calS_i\}_{i=1}^{n-1}$で，
各$S \in \calS_{n-1}$が$F$描画可能であるとき，定義より得られる連続な半代数関数$\map{\xi_1<\dots<\xi_k}{S}{R}$を
各$S$に対して取ることにより，$F$適合な$R^n$の柱状代数分解$\{\calS_i\}_{i=1}^n$を得ることができる．

次の命題は，$F$描画可能であることの必要条件を述べている．
なお，次の命題は，\cite[Proposition 5.14.]{MR2248869}を参照した．

\todo[inline]{以下の命題は条件2.が「相異なる実根」と，少し違った形で述べられている．誤植だと思う．}

\todo[inline]{以下の命題の証明が，教科書と全く同一ではない．}
\begin{proposition}\label{proposition:del}
     $F \subset R[X_1, \dots, X_n]$を有限部分集合とし，$S \subset R^{n-1}$を半代数的連結な半代数的集合とする．
     さらに，以下の条件を満たすとする．
     \begin{enumerate}
          \item \label{proposition:del-1}
          任意の$f \in F$に対し，$S$上$f$の$R[\sqrt{-1}]$上の根の数は重複度込みで一定である．
          \item \label{proposition:del-2}
          任意の$f \in F$に対し，$S$上$f$の$R[\sqrt{-1}]$上の相異なる根の数は一定である．
          \item \label{proposition:del-3}
          任意の$f, g \in F$に対し，$S$上$f$, $g$に共通する$R[\sqrt{-1}]$上の根の数は重複度込みで一定である．
     \end{enumerate}
     このとき，$S$は$F$描画可能である．
\end{proposition}


\cref{proposition:del}を示すために，補題を用意する．

\begin{lemma}\label{lemma:del}
     $S \subset R^{n-1}$を半代数的連結な半代数的集合とし，     
     $f \in R[x_1, \dots, x_n]$を$S$上恒等的に$0$でない多項式とする．
     さらに，次を満たすとする．
     \begin{enumerate}
          \item \label{lemma:del-1}
          $S$上$f$の$R[\sqrt{-1}]$上の根の数は重複度込みで一定．
          \item \label{lemma:del-2}
          $S$上$f$の$R[\sqrt{-1}]$上の相異なる根の数は一定．
     \end{enumerate}
     このとき，$S$は$\{f\}$描画可能である．
\end{lemma}

\begin{proof}
     まず，相異なる$R$上の根の個数が，$S$の上で一定であることを示す．

     $\map{N}{S}{R}$を，各$x \in S$に対し，$N(x)$を$f(x,X_n)$の相異なる$R$上の根の数で定める，
     すると，$N$は半代数的関数である．\footnote{$N$のグラフが1階述語論理式出かけることから従う．}
     
     さらに，$N$が局所定数関数であることを示す．
     $a \in S$を任意にとり，$f(a,X_n)$の$R$上の根を$z_1, \dots, z_s$, それ以外の根を$z_{s+1}, \dots, z_t$とする．

     $R$の元$r > 0$を，$\{D(z_i,r)\}_{i=1}^t$が非交叉になるようにとる．
     仮定の条件\ref{lemma:del-1}と\cref{theorem:continuity-of-roots}より，
     ある$a$の開近傍$V$が存在し，各$x \in V \cap S$に対して$f (x, X_n)$ の根が各 $D(z_i, r)$ ($i = 1, \dots , t$) の中に（重複
     度込みで）ちょうど $\mu_i$ 個であるようにとれる．
     ここで，仮定の条件\ref{lemma:del-2}より，$\{D(z_i, r)\}_{i=1}^t$は非交叉であること合わせて，
     各$D(z_i, r)$に含まれる全ての$f(x, X_n)$の根は一致しなければならない．

     さらに，各$x \in V \cap S$に対して，$f(x,X_n)$は$R$係数の$1$変数多項式であるから，
     $D(z_i, r)$ ($i=1, \dots, s$)に含まれるただ一つの根は$R$に値を取らなければならない．
     なぜなら，もしその根が$\alpha + \beta \sqrt{-1}$である場合，その共役$\alpha - \beta \sqrt{-1}$も根となり，
     $D(z_i, r)$に含まれる根がすべて一致することから$\beta = 0$となるためである．

     これで，各$x \in V \cap S$に対して，$f(x, X_n)$の$R$上の相異なる根の数が一定であることが示せた．
     すなわち，$N$は局所定数関数である事が示せた．

     よって，$S$が半代数的連結であることと$N$が局所定数な半代数的関数であることから，$N$は定数関数である．
     したがって，$R$上の相異なる根の個数は$S$上一定である．

     ここで，各$x \in S$に対し，$\xi_1(x) < \dots < \xi_k(x)$を，相異なる$f(x, X_n)$の$R$上の根として定める．
     このとき，先ほどの議論と同様にして，
     各$\xi_i$が連続で，多項式$f(x,X_n)$の各根$\xi_i(x)$の重複度は$x \in S$によらず一定であることが示せる．

     さらに，各$\map{\xi_i}{S}{R}$は，各グラフが半代数的集合となることから，いずれも半代数的関数である．

     よって，$S$は$\{f\}$描画可能であることが示された．
\end{proof}

\begin{proof}[{\bf \cref{proposition:del}の証明}]
     各$f \in F$は$S$上恒等的に$0$でないとしてよい．
     実際，$F' := \{f \in F \mid \text{$f$は$S$上恒等的に$0$でない}\}$とすると，$S$が$F$描画可能であることと$F'$描画可能であることは同値であるから，
     $F'$を$F$として証明すればよい．
     よって以下では，各$f \in F$は$S$上恒等的に$0$でないとして示す．

     \cref{lemma:del}より，各$f \in F$に対して，$S$は$\{f\}$描画可能である．
     よって，$S$上の連続な半代数的関数$\xi_{1,f}(a) < \dots < \xi_{n_f, f}(a)$を，各$a \in S$で$f(a)(x) \in R[x]$の解であるようにとれる．

     このとき，次の主張が成り立てば証明が完了する．

     \begin{claim*}
          $f, g \in F$が，$f \neq g$であるとする．
          ある$a \in S$において$\xi_{k,f}(a) = \xi_{l,g}(a)$であるならば，任意の$a \in S$に対して$\xi_{k,f}(a) = \xi_{l,g}(a)$である．
     \end{claim*}

     以下ではこの主張を示す．
     $\xi_{k,f}(a) = \xi_{l, g}(a)$であるような$a \in S$をとり，$a$の開近傍$V$で，
     任意の$x \in V \cap S$に対して$\xi_{k,f}(x) = \xi_{l,g}(x)$となるようなものが存在することを示せばよい．

     まず，$f_1(a, X_n), f_2(a, X_n)$の相異なる$R\left[\sqrt{-1}\right]$の共通根を，$z_1, \dots, z_j$とする．
     ただし，$z_1 = \xi_{k,f}(a)=\xi_{l,g}(a)$とする．
     さらに，\cref{theorem:continuity-of-roots}および仮定の条件\ref{proposition:del-1}, \ref{proposition:del-2}より，
     十分小さい$R$の元$r>0$と$a$の開近傍$V$を，
     任意の$x \in V \cap S$に対し，各$D(z_i, r)$に含まれる$f(x, X_n)$, $g(x, X_n)$それぞれの根はちょうど1つであり，
     根の重複度も$x$によらずに一定であるようにできる．

     ここで，$\xi_{k,f}, \xi_{l, g}$の連続性から，さらに$V$を小さくとれば，任意の$x \in V \cap S$に対し，
     $f(x, X_n)$の$D(z_1, r)$に含まれる唯一の根は$\xi_{k,f}(x)$であり，
     $g(x, X_n)$の$D(z_1, r)$に含まれる唯一の根は$\xi_{k,f}(x)$であるように取れる．

     さらに，仮定の条件\ref{proposition:del-3}から，各$D(z_i, r)$に含まれる$f(x, X_n)$, $g(x, X_n)$の唯一の根は一致しなければならない．
     したがって，任意の$x \in V \cap S$に対して$\xi_{k, f}(x) = \xi_{l, g}(x)$となることが示された．

     よって主張が示され，命題の証明が完了した．
\end{proof}

\cref{proposition:del}から次の系が成り立つ．

\begin{corollary}\label{corollary:del}
     $S \subset R^{n-1}$を弧状連結部分集合とし，$F \subset R[X_1,\dots, X_n]$を有限部分集合とする．
     次が成り立つとき，$S$は$F$描画可能である．
     \begin{enumerate}
          \item \label{corollary:del-1}
          任意の$f \in F$に対し，$\deg(f(a,X_n))$が一定（$a \in S$）．
          \item \label{corollary:del-2}
          任意の$f \in F$に対し，$\deg(\gcd(f(a,X_n), \frac{\partial f}{\partial X_n}(a,X_n)))$が一定（$a \in S$）．
          \item \label{corollary:del-3}
          任意の$f, g \in F$に対し，$\deg(\gcd(f(a,X_n), g(a,X_n)))$が一定（$a \in S$）．
     \end{enumerate}
\end{corollary}

よって，$F$符号不変な$R^n$の分割を与えるには，\cref{corollary:del}の条件を満たすような$R^{n-1}$の分割を構成すればよい．
条件\ref{corollary:del-1}を満たすような$R^{n-1}$の分割を与えるには，各$f \in F$について，$X_n$係数が符号不変になるような分割を構成すればよい．
一方，条件\ref{corollary:del-2}, \ref{corollary:del-3}を満たすような$R^{n-1}$の分割を与えるのは，条件\ref{corollary:del-1}に比べて少し難しい．
条件\ref{corollary:del-2}, \ref{corollary:del-3}も満たすような$R^{n-1}$の分割を与えることができるよう，次の節で準備をする．

\subsection{主部分終結式係数}

\todo[inline]{この節を書くのは後回しにする．理由は，適切な参考文献を見つけていないこと，証明を書くのが大変そうなのでやりたくないから．}

\begin{definition}
$\mathrm{R}$を可換環とし，$A(x), B(x) \in \mathrm{R}[x]$ を，$\deg A(x) = m$, $\deg B(x) = n$ とする．ただし，$\deg 0 = 0$と解釈する．

$j = 0, \dots, \min\{n, m\}$に対し，多項式$A(x)$, $B(x)$の$j$次部分終結式($j$-th subresultant) $S_j(A, B)$を次のように定義する．
\begin{align}
A(x) = a_m x^m + \dots + a_1 x + a_0, \\
B(x) = b_n x^n + \dots + b_1 x + b_0 
\end{align}
として，$j = 0, \dots, \min\{n,m\}$に対し，
\begin{align}
M_j = 
\begin{pmatrix}
a_m & a_{m-1} & \cdots & a_1 & a_0 &    &  \\
     &  a_m     & \cdots & a_2 & a_1& a_0 &  \\
     &   & \ddots &  & & \\
b_n & b_{n-1} & \cdots & b_1 & b_0 &    & \\
     &  b_n     & \cdots & b_2 & b_1& b_0 & \\
     &   & \ddots &  & & 
\end{pmatrix}
\in \mathrm{M}_{m+n-2j, m+n-j}(\mathrm{R})
\end{align}
とする．ここで，行列の空白部分はすべて$0$であり，また，行列の上側は$n-j$行，行列の下側は$m-j$行である．

また，$j = 0, \dots, \min\{m,n\}$, $i = 0, \dots, j$に対し，
\begin{align}
M_{j,i} = (\text{$M_j$の第$1$列}, \text{$M_j$の第$2$列}, \dots ,\text{$M_j$の第$m+n-2j-1$列}, \text{$M_j$の第$m+n-i-j$列})
\in \mathrm{M}_{m+n-2j, m+n-2j}(\mathrm{R})
\end{align}
とする．$j = 0, \dots, \min\{n, m\}$に対し，
\begin{align}
S_j(A, B) = \sum_{i=0}^j \det M_{j, i} \cdot x^i 
\end{align}
を多項式$A(x)$, $B(x)$の$j$次部分終結式$S_j(A, B)$という．

この$j$次部分終結式の先頭項係数を，$\psc_j(A,B)$とかき，多項式$A(x)$, $B(x)$の$j$次主部分終結式係数($j$-th principal subresultant coefficient)という．
\end{definition}


主部分終結式係数は，多項式$A(x)$, $B(x)$の係数，及び次数に依存して定まる．

\begin{remark}
$m$, $n$のどちらかが$0$のとき，
$S_0(A,B) = 0$, $\psc_0(A,B) = 0$とする．

また，$\psc_0(A,B)$は，多項式$A(x)$, $B(x)$の終結式に一致する．
\end{remark}

\begin{proposition}\label{proposition:psc}
$\mathrm{R}$を体とし，$A(x), B(x) \in \mathrm{R}[x] \setminus \{0\}$とすると，次が成立する．
\begin{align}
\deg(\gcd(A, B)) = \min \{ j  \in \{0,1, \dots, \min\{n,m\}\}\mid \psc_j(A,B) \neq 0\}
\end{align}
\end{proposition}

\begin{proof}
\todo[inline]{後で書く．方針： 部分終結式がユークリッドの互除法で出てくる多項式の列の定数倍になることが分かる．}
\end{proof}

\subsection{符号不変な柱状代数分割の存在}
この節では，\cref{theorem:cad}を証明する．

まず，次のような記号を定義する．

$f \in R[X_1, \dots, X_n]$に対し，$\Tru(f;X_n)$を，
\begin{equation}
     \Tru(f;X_n):= \begin{cases}
          \{f\} &  \text{if $\LC(f; X_n) \in R$ or $f \in R[X_1, \dots, X_{n-1}]$} \\
          \{f\} \cup \Tru(f-\LT(f;X_n);X_n) & \text{otherwise}
     \end{cases}
\end{equation}
により定義する．

また，有限部分集合$F \subset R[X_1, \dots, X_n]$に対し，$\Tru(F;X_n)$を，
\begin{equation}
     \Tru(F;X_n) := \bigcup_{f \in F} \Tru(f;X_n)
\end{equation}
により定義する．

以下の定義は，\cite[Section 3]{MR0764184}, \cite[Notation 5.15.]{MR2248869}
を参考にしているが，元々は\cite[Theorem 4]{MR0403962}で定義されたものである．


\begin{definition}
$F \subset R[X_1, \dots, X_n]$を有限部分集合とする．ただし，$n \geq 2$とする．
$\Elim_{X_n}(F) \subset R[X_1, \dots, X_{n-1}]$を，以下の集合の合併として定義する．
\begin{align} 
     &\{\LC(A;X_n) \mid A \in \Tru(F;X_n) \},\\
     &\left\{ \psc_j\left(A,\frac{\partial A}{\partial X_n};X_n\right) \middle| A \in \Tru(F;X_n), j= 0, \dots, \deg(A;X_n)-1\right\},\\
     &\{\psc_j(A,B;X_n) \mid A \neq B \in \Tru(F; X_n), j = 0, \dots, \min\{\deg(A;X_n), \deg(B;X_n)\}\}
     % \PSC(f,g;X_n) := \{\psc_j(f,g;X_n) \mid j = 0, \dots, \min\{\deg(f;X_n), \deg(g;X_n)\}\} \setminus \{0\}   
\end{align}
\end{definition}

この記号のもとで，次の系が成り立つ．なお，\cite[Theorem 5.16.]{MR2248869}を参考にした．

\begin{corollary}\label{corollary:inv-deline}
$F \subset R[X_1, \dots, X_n]$を有限部分集合とし，$S \subset R^{n-1}$を半代数連結な半代数的集合とする．

$S$が$\Elim_{X_n}(F)$符号不変ならば，$S$は$F$描画可能である．
\end{corollary}

\begin{proof}
\todo[inline]{詳細に証明を書く．}
\cref{proposition:del}及び\cref{proposition:psc}から従う．
\end{proof}

それでは，\cref{definition:cad}の証明を述べる．

\begin{proof}[\cref{theorem:cad}の証明]
     $n$についての帰納法によって示す．

     $n=1$の場合，$F$の$R$上の根を$a_1 < \dots < a_k$とする．
     $a_0 = -\infty$, $a_{k+1} = \infty$とすれば，
     \begin{equation}
          \calS_1 = \{(a_i, a_{i+1})\}_{i=0}^k \cup \{a_i\}_{i=1}^k
     \end{equation}
     が$F$-適合な柱状代数分解を与える．よって，定理は成り立つ．

     $n\geq 2$の場合，$n-1$までで主張が成り立つとする．
     このとき，帰納法の仮定により$\Elim_{X_n}(F)$適合な$R^{n-1}$の柱状代数分解を$\{\calS_i\}_{i=1}^{n-1}$がとれる．

     ここで，各$S \in \calS_{n-1}$は$\Elim_{X_n}(F)$符号不変であるから，\cref{corollary:inv-deline}より，$S$は$F$描画可能である．

     従って，各$S \in \calS_{n-1}$に対して，有限個の連続な半代数的関数$\map{\xi_{S,1}< \dots < \xi_{S,l_S}}{S}{R}$が存在し，
     \begin{itemize}
          \item 任意の$ x \in S $に対し，
          \begin{equation}
               \{\xi_{S,i}\}_{i=1}^{l_S} = \{y \in R \mid \prod_{f \in F'}f(x,y)=0\}
          \end{equation}
          である．ただし，$F' = \{f \in F \mid \text{$f$は$S$上恒等的に0でない}\}$とする．
          \item 各$i=1, \dots, l_S$および$f \in F'$に対し，多項式$f(x,X_n)$における根$\xi_{S,i}(x)$の重複度は，$x\in S$によらず一定．
     \end{itemize}
     であるようにとれる．
     また，$\xi_{S,0} := -\infty$, $\xi_{S,l_S} := \infty$とする．

     このとき，
     \begin{align}
          C_{S,2i} &:= \{(x,y) \mid  x \in S, \xi_{S,i}(x) = y \} \quad i = 1,\dots, l_S,\\
          C_{S,2i+1} &:= \{(x,y) \mid x \in S, \xi_{S,i}(x)<y<\xi_{S,i+1}(x) \} \quad i = 0,1, \dots, l_S 
     \end{align}
     とし，
     \begin{equation}
          \calS_n := \{C_{S,i} \mid S \in \calS_{n-1}, i=1, \dots, 2l_S+1\}
     \end{equation}
     とすれば，$\{\calS_i\}_{i=1}^n$は，$R^n$の$F$適合な柱状代数分解を与える．

     よって，帰納法により示された．
\end{proof}

% \begin{definition}
% $ F \subset \mathbb{R}[x_1,\dots,x_n] $ を有限部分集合とする．$ S \subset \mathbb{R}^{n-1} $が$ F $描画可能とする．
% このとき，$ S $上の$ F $の解を$ f_1(x)< \dots <f_k(x) $とし，$ f_0(x) := -\infty $ , $ f_{k+1}(x) := \infty $とするとき，
% \begin{align}
%   C_{2i} &:= \{(x,y) \mid  x \in S, f_i(x) = y \} \quad i = 1,\dots, k,\\
%   C_{2i+1} &:= \{(x,y) \mid x \in S, f_{i}(x)<y<f_{i+1}(x) \} \quad i = 0,1, \dots, k 
% \end{align}

% とすれば，$\{C_j\}_{j=1}^{2k+1}$は$ S \times \mathbb{R} $の$F$符号不変な分割を与える．
% この$ S \times \mathbb{R} $の分割$ \{C_j\}_{j=1}^{2k+1} $を，$ S $の持ち上げといい，$ \mathfrak{L}(S) $と書く．

% また，$\mathfrak{D}$が$\R^{n-1}$の分割であるとき，$\mathfrak{L}(\mathfrak{D}) := \bigcup_{D \in \mathfrak{D}}\mathfrak{L}(D)$を$\mathfrak{D}$の持ち上げという．
% \end{definition}

\section{柱状代数分解による量化記号消去}

有限部分集合$F \subset R[x_1, \dots, x_n]$が与えられたとき，
前節では$R^n$の$F$適合な柱状代数分解が存在することを示した．
この節では，柱状代数分解による量化記号消去のアルゴリズムについて示す．

\subsection{量化記号消去と柱状代数分解の関係}
まず，記号について定義する．
以下の定義は，\cite[Notation 11.7.]{MR2248869}を参考にした．
\begin{definition}
     $F \subset R[X_1, \dots, X_n]$を有限部分集合とする．

     まず，$\map{\sign(F)}{R^n}{\{-1, 0, 1\}^F}$を，
     $\sign(F)(x)(f):= \sign(f(x)), f \in F$により定義する．

     次に，各$y \in R^i$に対し，$\CSIGN_i(F)(y)$を以下のように定義する．
     \begin{itemize}
          \item $i=n$のとき，$x \in R^i$に対し，$\CSIGN_n(F)(x):= \sign(F)(x) $とする．
          \item $0 \leq i<n$のとき，$y \in R^i$に対し，
          \begin{equation}
               \CSIGN_i(F)(y) := \{\CSIGN_{i+1}(F)(x) \mid x \in  R^{i+1}, \pi_i(x) = y\}
          \end{equation}
          と定める．ここで，$\map{\pi_i}{R^{i+1}}{R^i}$は，$\pi_i(x_1, \dots, x_i, x_{i+1}) = (x_1, \dots, x_i)$で定義される写像とする．
     \end{itemize}
\end{definition}

上記の記号の元で，以下が成り立つ．
\begin{proposition}
     $F \subset R[X_1, \dots, X_n]$とし，$\{\calS_i\}_{i=1}^n$を$R^n$の$F$適合な柱状代数分解とする．
     このとき，任意の$i=1, \dots, n$, $S \in \calS_i$に対し，$\CSIGN_i(y)$は$y \in S$に対して一定である．
\end{proposition}

\begin{proof}
     証明を書く．
\end{proof}

\todo[inline]{
     以下の定義は厳密な定義ではない．まず，$F$論理式が定義されていない．
     量化記号のない$F$論理式は，$F$に属する多項式の等号不等号，
     および論理記号$\lor, \lnot, \land(, \rightarrow)$のみで記述された論理式の事である．}

また，次のような記号を定義する．以下の定義は，\cite[Notation 11.12.]{MR2248869}を参照した．
\begin{definition}
     $F \subset R[X_1, \dots, X_n]$を有限部分集合とし，$\map{\sigma}{F}{\{-1, 0, 1\}}$とする．
     量化記号のない$F$論理式$\phi(X)$に対して，$\phi^\star(\sigma) \in \{\true, \false\}$を以下のように帰納的に定義する．
     \begin{enumerate}
          \item $\phi(X)$が$(f(X)=0)$, $f \in F$, であるとき，
          \begin{equation}
               \phi^\star(\sigma):= \begin{cases}
                    \true  & \text{if $\sigma(f)=0$}\\
                    \false & \text{otherwise}
               \end{cases}
          \end{equation}
          と定義する．
          \item $\phi(X)$が$(f(X)>0)$, $f \in F$, であるとき，
          \begin{equation}
               \phi^\star(\sigma):= \begin{cases}
                    \true  & \text{if $\sigma(f)=1$}\\
                    \false & \text{otherwise}
               \end{cases}
          \end{equation}
          と定義する．
          \item $\phi(X)$が$(f(X)<0)$, $f \in F$, であるとき，
          \begin{equation}
               \phi^\star(\sigma):= \begin{cases}
                    \true  & \text{if $\sigma(f)=-1$}\\
                    \false & \text{otherwise}
               \end{cases}
          \end{equation}
          と定義する．
          \item $\phi(X):=(\phi_1(X) \land \phi_2(X))$であるとき，
          \begin{equation}
               \phi^\star(\sigma):= \begin{cases}
                    \true  & \text{if $\phi_1^\star(\sigma)=\true$ and $\phi_2^\star(\sigma)=\true$}\\
                    \false & \text{otherwise}
               \end{cases}
          \end{equation}
          と定義する．
          \item $\phi(X):=(\phi_1(X) \lor \phi_2(X))$であるとき，
          \begin{equation}
               \phi^\star(\sigma):= \begin{cases}
                    \true  & \text{if $\phi_1^\star(\sigma)=\true$ or $\phi_2^\star(\sigma)=\true$}\\
                    \false & \text{otherwise}
               \end{cases}
          \end{equation}
          \item $\phi(X):=(\lnot \phi_1(X))$であるとき，
          \begin{equation}
               \phi^\star(\sigma):= \begin{cases}
                    \true  & \text{if $\phi_1^\star(\sigma)=\false$}\\
                    \false & \text{otherwise}
               \end{cases}
          \end{equation}
     \end{enumerate}
\end{definition}

上記の記号の元で以下が成り立つ．以下の命題は，\cite[Proposition 11.14.]{MR2248869}を参考にした．
\todo[inline]{以下の命題は，\cite[Proposition 11.14.]{MR2248869}を参考にしているが，全く同一ではなく，QEの問題の場合のために言い換えている．}
\begin{proposition}
     $F \subset R[Y_1, \dots, Y_m, X_1, \dots, X_n]$を有限部分集合とし，
     \begin{equation}
          \Phi(Y):= \Qua_1 X_1 \dots \Qua_n X_n \phi(Y,X)
     \end{equation}
     とする．ただし，$\phi(Y,X)$は量化記号のない$F$論理式であり，$\Qua_i \in \{\forall, \exists\}$とする．

     このとき，任意の$y \in R^m$に対し，$\Phi(y)$が成り立つことと，
     \begin{equation}
          \Qua_1 \sigma_1 \in \CSIGN_m(F)(y) \Qua_2 \sigma_2 \in \sigma_1 \dots \Qua_n \sigma_n \in \sigma_{n-1} (\phi^\star(\sigma_n) = \true)
     \end{equation}
     が同値である．
\end{proposition}

\begin{proof}
     後で書く．
\end{proof}

量化記号消去と柱状代数分解の関係は以下の系のように述べられる．
\begin{corollary}
     $F \subset R[Y_1, \dots, Y_m, X_1, \dots, X_n]$を有限部分集合とし，
     \begin{equation}
          \Phi(Y):= \Qua_1 X_1 \dots \Qua_n X_n \phi(Y,X)
     \end{equation}
     とする．ただし，$\phi(Y,X)$は量化記号のない$F$論理式であり，$\Qua_i \in \{\forall, \exists\}$とする．
     また，$\{\calS_i\}_{i=1}^{n+m}$を$R^{n+m}$の$F$適合な柱状代数分解とする．

     このとき，
     \begin{equation}
          \Qua_1 \sigma_1 \in \CSIGN_m(F)(S) \Qua_2 \sigma_2 \in \sigma_1 \dots \Qua_n \sigma_n \in \sigma_{n-1}(\phi^\star(\sigma_n) = \true)
     \end{equation}
     が成り立つような$S \in \calS_m$の合併は，$\{y \in R^m \mid \Phi(y)\}$に一致する．
\end{corollary}

\begin{proof}
     後で書く．
\end{proof}


有限部分集合$F \subset R[X_1, \dots, X_n]$に対して，$\CSIGN_i(F)$を計算する方法について説明する．

\begin{definition}
     $\{\calS_i\}_{i=1}^n$を$R^n$の柱状代数分解とする．
     $\mathcal{A}=\{\mathcal{A}_{i}\}_{i=1}^n$が，$\mathcal{A}_i \subset R^i$, $\pi_i(\mathcal{A}_{i+1}) = \mathcal{A}_i$を満たすとする．
     ただし，$\map{\pi_i}{R^{i+1}}{R^i}$は，$\pi_i(x_1, \dots, x_i, x_{i+1}) = (x_1, \dots, x_i)$により定まる射影とする．
     
     このとき，$\mathcal{A}$が柱状代数分解$\{\calS_i\}_{i=1}^n$の標本点の柱状集合(cylindrical set of sample points)であるとは，
     各$i=1, \dots, n$と$S\in \calS_i$に対し，$\mathcal{A}_i\cap S \neq \emptyset$を満たすことと定義する．
\end{definition}

\begin{definition}
     $F \subset R[X_1, \dots, X_n]$を有限部分集合とする．
     $\mathcal{A}=\{\mathcal{A}_{i}\}_{i=1}^n$が，$\mathcal{A}_i \subset R^i$, $\pi_i(\mathcal{A}_{i+1}) = \mathcal{A}_i$を満たすとする．
     ただし，$\map{\pi_i}{R^{i+1}}{R^i}$は，$\pi_i(x_1, \dots, x_i, x_{i+1}) = (x_1, \dots, x_i)$により定まる射影とする．

     このとき，$i=1, \dots, n$, $z \in \mathcal{A}_i$に対し，$\CSIGN_i(F, \mathcal{A})(z)$を以下のように定義する．
     \begin{itemize}
          \item $i=n$のとき，$y \in \mathcal{A}_n$に対し，$\CSIGN_n(F, \mathcal{A})(y):=\sign(F)(y)$とする．
          \item $0 \leq i < n$のとき，$y \in \mathcal{A}_i$に対し，
          \begin{equation}
               \CSIGN_i(F, \mathcal{A})(y):= \{\CSIGN_{i+1}(F, \mathcal{A})(x) \mid x \in \mathcal{A}_{i+1}, \pi_i(x) = y\}
          \end{equation}
          と定める．
     \end{itemize}
\end{definition}

このとき，次の命題が成り立つ．以下の命題は，\cite[Proposition 11.9.]{MR2248869}を参照した．
\begin{proposition}
     $F \subset R[X_1, \dots, X_n]$を有限部分集合とし，$\{\calS_i\}_{i=1}^n$を$R^n$の$F$適合な柱状代数分解とする．
     また，$\mathcal{A}:= \{\mathcal{A}_{i}\}_{i=1}^n$を$\{\calS_i\}_{i=1}^n$の標本点の柱状集合とする．
     このとき，各$i=0, \dots, n$に対して
     \begin{equation}
          \CSIGN_i(F) = \CSIGN_i(F, \mathcal{A})
     \end{equation}
     が成り立つ．
\end{proposition}

\begin{proof}
     後で書く．
\end{proof}


\subsection{柱状代数分解の改良}
多項式の有限部分集合$F \subset R[X_1, \dots, X_n]$に対し，$\map{\sigma}{F}{\{-1,0,1\}}$を，$F$の符号条件(sign condition)という．
さらに，$F$の符号条件$\sigma$が与えられたとき，
\begin{equation}
     \Reali(\sigma):= \{x \in R^k \mid \bigwedge_{f \in F} \sign(f(x)) = \sigma(f)\}
\end{equation}
により定義される$\Reali(\sigma)$を，符号条件$\sigma$の実現(realization)という．

\todo[inline]{以下の定義も微妙．$0 \in F$にした方がよいのではないか．}
また，多項式の有限部分集合$F \subset R[X]$が，
微分について閉じている(closed under differentiation)
とは，$0 \not \in F$であり，かつ任意の$f \in F$に対して，$f' \in F$または$f'=0$となることと定義する．


以下の命題の主張は，\cite[Lemma 5.33.]{MR2248869}を参照した．

\begin{proposition}\label{proposition:Thom}
     有限部分集合$F \subset R[X]$が，微分について閉じているとする．
     このとき， 任意の$F$の符号条件$\map{\sigma}{F}{\{-1,0,1\}}$に対し，
     $\Reali(\sigma)$は空集合，一点からなる集合，開区間のいずれかである．
\end{proposition}

\begin{proof}
     $F = \{f_1, \dots, f_s\}$として，$s$に関する帰納法で示す．
     $s = 0$のときは明らかである．
     
     次に，$s$において主張が成り立つとする．
     $F = \{f_1, \dots, f_{s+1}\}$について，順番を並び替えて$f_{s+1}$の次数が最大であるとする．

     任意に$\map{\sigma}{F}{\{-1,0,1\}}$をとる．
     $\map{\sigma_0}{F \setminus \{f_{s+1}\}}{\{-1,0,1\}}$を$\sigma$の制限，すなわち
     \begin{equation}
          \sigma_0(f_i) := \sigma(f_i), \quad i=1, \dots, s
     \end{equation}
     とする．

     このとき，$F_0 := \{f_1, \dots, f_{s}\}$は微分について閉じているので，帰納法の仮定より，
     $\Reali(\sigma_0)$は，空集合，一点からなる集合，開区間のいずれかである．

     $\Reali(\sigma) = \Reali({\sigma_0}) \cap \{x \in R \mid \sign(f_{s+1}(x)) = \sigma(f_{s+1})\}$であるから，
     $\Reali({\sigma_0})$が空集合，あるいは一点からなる集合の場合には，$\Reali(\sigma)$は空集合か一点からなる集合になるので主張は成り立つ．

     したがって，$\Reali({\sigma_0})$が開区間である場合を考える．
     $f_{s+1}$の微分$f_{s+1}'$は，$f_1, \dots, f_s$のいずれかであるから，$\Reali({\sigma_0})$上符号は一定である．

     $f_{s+1}'$の符号が$\Reali({\sigma_0})$上常に$0$である場合，$f_{s+1}$は$\Reali({\sigma_0})$上定数であるから，主張は成り立つ．

     $f_{s+1}'$の符号が$\Reali({\sigma_0})$上常に$-1$(あるいは$1$)の場合を考える．
     このとき\cref{corollary:monotone}より，$f$は$\Reali({\sigma_0})$上狭義単調増加(あるいは狭義単調減少)であるから，$\Reali(\sigma)$は空集合，一点からなる集合，開区間のいずれかである．

     以上より，主張は示された．
\end{proof}

次の定理は，\cite[Theorem 5.34.]{MR2248869}を参考にした．
\begin{theorem}
     $F \subset R[X_1, \dots, X_n]$を有限部分集合とし，
     $\{F_i\}_{i=1}^n$が以下を満たすとする．
     \begin{itemize}
          \item $F \subset F_n$である．\\
          \item 各$i=1,\dots, n$に対して，$F_i \subset R[X_1, \dots, X_i]$であり，$F_i$は$X_i$での微分について閉じている．\\
          \item 各$i=1, \dots, n-1$に対して，$\Elim_{X_{i+1}}(F_{i+1}) \subset F_i$を満たす．
     \end{itemize}

     このとき，$F_{\leq i}:=\cup_{j \leq i} F_j$として，各$i=1, \dots, n$に対し
     \begin{equation}
          \calS_i := \{\Reali(\sigma) \mid \map{\sigma}{F_{\leq i}}{\{-1,0,1\}}\} \setminus \{\emptyset\}
     \end{equation}          
     と定義すると，$\{\calS_i\}_{i=1}^n$は$F$適合な柱状代数分解である．
\end{theorem}

\begin{proof}
     $n$に関する帰納法で示す．

     $n=1$の場合，\cref{proposition:Thom}により主張が従う．

     次に，$n>1$の場合について示す．$n-1$で主張が成り立っていると仮定すると，帰納法の仮定より
     $\{\calS_{i}\}_{i=1}^{n-1}$は$F_{n-1}$適合な柱状代数分解である．

     $\Elim_{X_n}(F_n) \subset F_{n-1}$であるから，各$S \in \calS_{n-1}$はいずれも$\Elim_{X_n}(F_n)$符号不変である．
     よって，\cref{corollary:inv-deline}より，各$S \in \calS_{n-1}$は$F_n$描画可能である．

     従って，定義より$l_S$個の連続な半代数的関数$\map{\xi_1<\dots<\xi_{l_S}}{S}{R}$を，次を満たすように取れる．
     \begin{itemize}
          \item 任意の$ x \in S $に対し，
          \begin{equation}
               \{\xi_i(x)\}_{i=1}^{l_S} = \{y \in R \mid \prod_{f \in F_n'}f(x,y)=0\}
          \end{equation}
          である．ただし，$F_n' = \{f \in F_n \mid \text{$f$は$S$上恒等的に$0$でない}\}$とする．
          \item 各$i=1, \dots, l_S$および$f \in F_n'$に対し，多項式$f(x,X_n)$における根$\xi_i(x)$の重複度は，$x\in S$によらず一定．
     \end{itemize}
     また，$\xi_{S,0} := -\infty$, $\xi_{S,l_S} := \infty$とする．

     このとき，$S \in \calS_{n-1}$に対し，
     \begin{align}
          C_{S,2i} &:= \{(x,y) \mid  x \in S, \xi_{S,i}(x) = y \} \quad i = 1,\dots, l_S,\\
          C_{S,2i+1} &:= \{(x,y) \mid x \in S, \xi_{S,i}(x)<y<\xi_{S,i+1}(x) \} \quad i = 0,1, \dots, l_S 
     \end{align}
     とし，
     \begin{equation}
          \widetilde{\calS}_n := \{C_{S,i} \mid S \in \calS_{n-1}, i=1, \dots, 2l_S+1 \}
     \end{equation}
     と定義すれば，$\{\calS_i\}_{i=1}^{n-1} \cup \{\widetilde{\calS}_n\}$は$F_n$適合な柱状代数分解を与える．

     そこで，$\widetilde{\calS}_n = \calS_n$となることを示す．
     そのために，$S:=\Reali(\widetilde{\sigma}) \neq \emptyset$である$\map{\widetilde{\sigma}}{F_{\leq n-1}}{\{-1,0,1\}}$を任意にとり，
     \begin{equation}
          \{C_{S,i} \mid i=1, \dots, 2l_S + 1\} = \{\Reali(\sigma) \mid \map{\sigma}{F_{\leq n}}{\{-1,0,1\}}, \sigma|_{F_{\leq n-1}} = \widetilde{\sigma}\} \setminus \{\emptyset\}
     \end{equation}
     となることを示す．両辺の集合族は，$S \times R$の非交叉な被覆であることに注意する．

     任意の$i=1, \dots, 2l_S+1$に対し，$C_{S,i}$は$F_{\leq n}$符号不変であるから，
     $\sigma|_{F_{\leq n-1}} = \widetilde{\sigma}$を満たす$\map{\sigma}{F_{\leq n}}{\{-1,0,1\}}$がただ一つ存在して，
     $C_{S,i} \subset \Reali(\sigma)$である．
     また，\cref{proposition:Thom}より，$\sigma|_{F_{\leq n-1}} = \widetilde{\sigma}$を満たす任意の$\sigma$および
     $i,j \in \{1, \dots, 2l_S + 1\}$に対して，
     $C_{S,i} \subset \Reali(\sigma)$, $C_{S,j} \subset \Reali(\sigma)$ならば，$i=j$である．

     以上で命題が示された．
\end{proof}

\subsection{柱状代数分解による量化記号消去のアルゴリズム}

柱状代数分解による量化記号消去のアルゴリズムは，次のように述べられる．

\begin{algorithm}
     \caption{Improved Cylindrical Decomposition}
     \begin{algorithmic}[1]
          \REQUIRE 
               有限部分集合
               $F \subset R[X_1, \dots, X_n]$
               および，順序付けられた変数のリスト$X_1, \dots, X_n$
          \ENSURE
               $\overline{C}_i(F) \subset R[X_1, \dots, X_i]$をみたす有限集合の列$\left\{\overline{C}_i(F)\right\}_{i=1}^n$
          \STATE $\overline{C}_k(F)\leftarrow \{\partial^i f/ \partial X_k^i \mid f \in F, i=0,1,\dots \}$
          \\ \text{Elimination Phase}:
          \FOR{$i = k-1, \dots, 1$}
               \STATE $\overline{C}_i(F) \leftarrow \Elim_{X_{i+1}}(\overline{C}_{i+1}(F))$
               \STATE $\overline{C}_i(F) \leftarrow \{ \partial^i f/ \partial X_i^j \mid f \in  \overline{C_i}(F), j=0,1, \dots\}$
          \ENDFOR
          \\ \text{Lifting Phase}:
          \STATE $\overline{C}_1(F)$の各多項式の根と，それらで分離される開区間上の点からなる点のリストを$A_1$とする．
          \FOR{$i = 2, \dots, k$}
               \FOR{$x \in A_{i-1}$}
                    \STATE $L \leftarrow \{P_i(x, X_i) \mid P_i \in \overline{C}_i(F)\}$
                    \STATE $L$の各多項式の根と，それらで分離される開区間上の点から点のリスト$\widetilde{A}_i$をとる．
                    \STATE $A_i \leftarrow A_i \cup \{(x, y)\mid y \in \widetilde{A}_i\}$
               \ENDFOR
          \ENDFOR
          \RETURN $\{\overline{C}_i(F)\}$, $\{A_i\}$, そして実際に各標本点で成り立っている$\overline{C}_{\leq i}(F)$の符号条件
     \end{algorithmic}
\end{algorithm}

\begin{algorithm}
     \caption{Cylindrical Quantifier Elimination}
     \begin{algorithmic}[1]
          \REQUIRE 
               有限部分集合
               $F \subset R[Y_1, \dots, Y_m][X_1, \dots, X_n]$,
               および$F$論理式
               \[\Phi(Y) = (\Qua_1 X_1)(\Qua_2 X_2)\dots(\Qua_n X_n) \phi(Y,X),\]
               ただし，各$\phi(Y,X)$は量化記号のない$F$論理式とする．
          \ENSURE 
               $\Phi(Y)$に同値な量化記号のない論理式.
          \STATE $Y_1, \dots, Y_m, X_1, \dots, X_n$と$F$に対して，Improved Cylindrical Decompositionを適応する．
          \FOR{$\sigma \in \overline{C}_{\leq m}(F)$}
               \STATE $\calL \leftarrow \{\}$
               \IF{$\Reali(\sigma) \neq \emptyset$}
                    \STATE $\CSIGN_m(F)(\sigma) \leftarrow \CSIGN_m(F)(\Reali(\sigma))$ 
                    \IF{$ \Qua_1 \mu_1 \in \CSIGN_m(F)(\sigma) \dots \Qua_n \mu_n \in \mu_{n-1} \phi^\star(\mu_n) = \true$}
                         \STATE $\calL \leftarrow \calL \cup \{\sigma\}$
                    \ENDIF
               \ENDIF
          \ENDFOR
          \RETURN $\bigvee_{\sigma \in \calL} \bigwedge_{f \in \overline{C}_{\leq m}(F)}f(Y)=\sigma(f)$
     \end{algorithmic}
\end{algorithm}

% \begin{thebibliography}{99}
%      \bibitem{Arai} 新井敏康，『数学基礎論』(2016).
%      \bibitem{Itai} 板井昌典，『モデル理論』(2023).
%      \bibitem{Anai} 穴井宏和，横山和弘，『QEの計算アルゴリズムとその応用 数式処理による最適化』(2011).
%      \bibitem{Artin} Artin, E., Schreier, O. Algebraische Konstruktion reeller Körper. Abh.Math.Semin.Univ.Hambg. 5, 85–99 (1927). https://doi.org/10.1007/BF02952512
%      \bibitem{Bochnak}Jacek Bochnak, Michel Coste, Marie-Fran\c{c}oise Roy, Real Algebraic Geometry, Springer(1998).
%      \bibitem{Basu} Saugata Basu, Richard Pollack, Marie-Fran\c{c}oise Roy, Algorithms in Real Algebraic Geometry(2003).
%      \bibitem{Collins} George E. Collins, Quantifier elimination for real closed fields by cylindrical algebraic decomposition(1975).
% \end{thebibliography}


\bibliographystyle{alpha}
\bibliography{references.bib}
\end{document}